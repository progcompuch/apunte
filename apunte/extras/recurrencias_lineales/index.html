<!doctype html><html lang=es><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=preload as=font href=/fonts/vendor/jost/jost-v4-latin-regular.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=/fonts/vendor/jost/jost-v4-latin-500.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=/fonts/vendor/jost/jost-v4-latin-700.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=/fonts/KaTeX_Main-Regular.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=/fonts/KaTeX_Math-Italic.woff2 type=font/woff2 crossorigin><script>(()=>{var t=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,e=localStorage.getItem("theme");t&&e===null&&(localStorage.setItem("theme","dark"),document.documentElement.setAttribute("data-dark-mode","")),t&&e==="dark"&&document.documentElement.setAttribute("data-dark-mode",""),e==="dark"&&document.documentElement.setAttribute("data-dark-mode","")})()</script><link rel=stylesheet href=/main.8d4c55b346982a6339182e4ee982f79990543101bb0af2bfa2bdb6e41188623c934c182f1e7421e16d4a5c4d9fdca568d9ef51e627a2cc3c8d156535f3d7396c.css integrity="sha512-jUxVs0aYKmM5GC5O6YL3mZBUMQG7CvK/or225BGIYjyTTBgvHnQh4W1KXE2f3KVo2e9R5ieizDyNFWU189c5bA==" crossorigin=anonymous><noscript><style>img.lazyload{display:none}</style></noscript><meta name=robots content="index, follow"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><title>Recurrencias lineales - Programación Competitiva UChile</title><meta name=description content="Introducción # Las recurrencias lineales se ven como secuencias que cumplen una ecuación del tipo:
$$ a_k = \sum_{i\geq 1} c_i(k)a_{k-i} + f(k) $$
Es decir, secuencias donde cada valor depende de una función lineal de los valores anteriores, más alguna función de k.
Hay un sinfín de variedad de estas, la más clásica de todas siendo:
$$ f_k = f_{k-1} + f_{k-2} $$
La secuencia de Fibonacci. Otra clase de secuencias que podemos expresar usando esta terminología es: $$ T_n = 2T_{\lceil n/2 \rceil} + O(n) $$"><link rel=canonical href=/apunte/extras/recurrencias_lineales/><meta property="og:locale" content="es_CL"><meta property="og:type" content="article"><meta property="og:title" content="Recurrencias lineales"><meta property="og:description" content="Introducción # Las recurrencias lineales se ven como secuencias que cumplen una ecuación del tipo:
$$ a_k = \sum_{i\geq 1} c_i(k)a_{k-i} + f(k) $$
Es decir, secuencias donde cada valor depende de una función lineal de los valores anteriores, más alguna función de k.
Hay un sinfín de variedad de estas, la más clásica de todas siendo:
$$ f_k = f_{k-1} + f_{k-2} $$
La secuencia de Fibonacci. Otra clase de secuencias que podemos expresar usando esta terminología es: $$ T_n = 2T_{\lceil n/2 \rceil} + O(n) $$"><meta property="og:url" content="/apunte/extras/recurrencias_lineales/"><meta property="og:site_name" content="Programación Competitiva UChile"><meta property="og:image" content="/logo_redondo.png"><meta property="og:image:alt" content="Programación Competitiva UChile"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content="@dccuchile"><meta name=twitter:creator content="@dccuchile"><meta name=twitter:title content="Recurrencias lineales"><meta name=twitter:description content><meta name=twitter:image content="/logo_redondo.png"><meta name=twitter:image:alt content="Recurrencias lineales"><script type=application/ld+json>{"@context":"https://schema.org","@graph":[{"@type":"Person","@id":"/#/schema/person/1","name":"","url":"/","sameAs":[],"image":{"@type":"ImageObject","@id":"/#/schema/image/1","url":"/\u003cnil\u003e","width":null,"height":null,"caption":""}},{"@type":"WebSite","@id":"/#/schema/website/1","url":"/","name":"Programación Competitiva UChile","description":"Grupo organizado de Programación Competitiva en la Universidad de Chile.","publisher":{"@id":"/#/schema/person/1"}},{"@type":"WebPage","@id":"/apunte/extras/recurrencias_lineales/","url":"/apunte/extras/recurrencias_lineales/","name":"Recurrencias lineales","description":"","isPartOf":{"@id":"/#/schema/website/1"},"about":{"@id":"/#/schema/person/1"},"datePublished":"0001-01-01T00:00:00CET","dateModified":"0001-01-01T00:00:00CET","breadcrumb":{"@id":"/apunte/extras/recurrencias_lineales/#/schema/breadcrumb/1"},"primaryImageOfPage":{"@id":"/apunte/extras/recurrencias_lineales/#/schema/image/2"},"inLanguage":"","potentialAction":[{"@type":"ReadAction","target":["/apunte/extras/recurrencias_lineales/"]}]},{"@type":"BreadcrumbList","@id":"/apunte/extras/recurrencias_lineales/#/schema/breadcrumb/1","name":"Breadcrumbs","itemListElement":[{"@type":"ListItem","position":1,"item":{"@type":"WebPage","@id":"/","url":"/","name":"Home"}},{"@type":"ListItem","position":2,"item":{"@id":"/apunteextrasrecurrencias_lineales/"}}]},{"@context":"https://schema.org","@graph":[{"@type":"ImageObject","@id":"/apunte/extras/recurrencias_lineales/#/schema/image/2","url":"/logo_redondo.png","contentUrl":"/logo_redondo.png","caption":"Recurrencias lineales"}]}]}</script><meta name=theme-color content="#fff"><link rel=icon href=/favicon.ico sizes=any><link rel=icon type=image/svg+xml href=/favicon.svg><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest crossorigin=use-credentials href=/site.webmanifest></html><body class="docs single"><div class=sticky-top><div class=header-bar></div><header class="navbar navbar-expand-lg navbar-light doks-navbar"><nav class="container-xxl flex-wrap flex-lg-nowrap" aria-label="Main navigation"><a class="navbar-brand order-0" href=/ aria-label="Programación Competitiva UChile"><img class=invertible src=/images/banner.svg></a>
<button class="btn btn-link order-0 ms-auto d-lg-none" type=button data-bs-toggle=offcanvas data-bs-target=#offcanvasExample aria-controls=offcanvasExample><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-more-horizontal"><circle cx="12" cy="12" r="1"/><circle cx="19" cy="12" r="1"/><circle cx="5" cy="12" r="1"/></svg></button><div class="offcanvas offcanvas-start d-lg-none" tabindex=-1 id=offcanvasExample aria-labelledby=offcanvasExampleLabel><div class=header-bar></div><div class=offcanvas-header><h5 class=offcanvas-title id=offcanvasExampleLabel>Navegar apunte</h5><button type=button class=btn-close data-bs-dismiss=offcanvas aria-label=Close></button></div><div class=offcanvas-body><aside class="doks-sidebar mt-n3"><nav id=doks-docs-nav aria-label="Tertiary navigation"><ul class="list-unstyled collapsible-sidebar"><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-apunte-prologo aria-expanded=false>
Prólogo</button><div class=collapse id=section-apunte-prologo><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/apunte/prologo/introduccion/>Introducción</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-apunte-introduccion aria-expanded=false>
Introducción</button><div class=collapse id=section-apunte-introduccion><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/apunte/introduccion/compilacion_y_editores/>Compilación y editores de texto</a></li><li><a class="docs-link rounded" href=/apunte/introduccion/sintaxis_variables_tipos_ciclos/>Sintaxis, variables, tipos y ciclos</a></li><li><a class="docs-link rounded" href=/apunte/introduccion/funciones/>Funciones</a></li><li><a class="docs-link rounded" href=/apunte/introduccion/vectores/>Vectores</a></li><li><a class="docs-link rounded" href=/apunte/introduccion/operadores_de_bits/>Operadores de bits</a></li><li><a class="docs-link rounded" href=/apunte/introduccion/analisis_de_complejidad/>Análisis de complejidad</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-apunte-libreria_estandar aria-expanded=false>
Librería estándar de C++</button><div class=collapse id=section-apunte-libreria_estandar><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/apunte/libreria_estandar/char_string/>Char y string</a></li><li><a class="docs-link rounded" href=/apunte/libreria_estandar/pair_tuple/>Pair y tuple</a></li><li><a class="docs-link rounded" href=/apunte/libreria_estandar/sort/>Sort</a></li><li><a class="docs-link rounded" href=/apunte/libreria_estandar/set_map_multiset/>Set, map y multiset</a></li><li><a class="docs-link rounded" href=/apunte/libreria_estandar/stack_queue/>Stack y queue</a></li><li><a class="docs-link rounded" href=/apunte/libreria_estandar/priority_queue/>Priority queue</a></li><li class="my-1 ms-3"><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-apunte-libreria_estandar-extras aria-expanded=false>
Extras</button><div class=collapse id=section-apunte-libreria_estandar-extras><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/apunte/libreria_estandar/extras/permutaciones_de_un_arreglo/>Permutaciones de un vector</a></li></ul></div></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-apunte-paradigmas_de_resolucion aria-expanded=false>
Paradigmas de resolución</button><div class=collapse id=section-apunte-paradigmas_de_resolucion><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/apunte/paradigmas_de_resolucion/busqueda_binaria/>Búsqueda binaria</a></li><li><a class="docs-link rounded" href=/apunte/paradigmas_de_resolucion/programacion_dinamica/>Programación dinámica</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-apunte-estructuras_de_datos aria-expanded=false>
Estructuras de datos</button><div class=collapse id=section-apunte-estructuras_de_datos><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/apunte/estructuras_de_datos/union_find/>Union-find</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-apunte-grafos aria-expanded=false>
Grafos</button><div class=collapse id=section-apunte-grafos><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/apunte/grafos/introduccion/>Introducción</a></li><li><a class="docs-link rounded" href=/apunte/grafos/busqueda_en_grafos/>Búsqueda en grafos (BFS y DFS)</a></li><li><a class="docs-link rounded" href=/apunte/grafos/caminos_ciclos_eulerianos/>Caminos y ciclos eulerianos</a></li><li><a class="docs-link rounded" href=/apunte/grafos/minimum_spanning_tree/>Minimum spanning tree</a></li><li><a class="docs-link rounded" href=/apunte/grafos/caminos_mas_cortos/>Caminos más cortos</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-apunte-extras aria-expanded=true>
Extras</button><div class="collapse show" id=section-apunte-extras><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded active" href=/apunte/extras/recurrencias_lineales/>Recurrencias lineales</a></li><li><a class="docs-link rounded" href=/apunte/extras/treaps/>Treaps</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-apunte-geometria aria-expanded=false>
Geometría</button><div class=collapse id=section-apunte-geometria><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/apunte/geometria/puntos/>Puntos</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-apunte-anexos aria-expanded=false>
Anexos</button><div class=collapse id=section-apunte-anexos><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/apunte/anexos/template/>Template</a></li></ul></div></li></ul></nav></aside></div></div><button class="btn btn-menu order-2 d-block d-lg-none" type=button data-bs-toggle=offcanvas data-bs-target=#offcanvasDoks aria-controls=offcanvasDoks aria-label="Open main menu"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button><div class="offcanvas offcanvas-end border-0 py-lg-1" tabindex=-1 id=offcanvasDoks data-bs-backdrop=true aria-labelledby=offcanvasDoksLabel><div class="header-bar d-lg-none"></div><div class="offcanvas-header d-lg-none"><h2 class="h5 offcanvas-title ps-2" id=offcanvasDoksLabel><a class=text-dark href=/>Programación Competitiva UChile</a></h2><button type=button class="btn-close text-reset me-2" data-bs-dismiss=offcanvas aria-label="Close main menu"></button></div><div class="offcanvas-body p-4 p-lg-0"><ul class="nav flex-column flex-lg-row align-items-lg-center mt-2 mt-lg-0 ms-lg-2 me-lg-auto"><li class=nav-item><a class="nav-link ps-0 py-1 active" href=/apunte/prologo/introduccion>Apunte</a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=/recursos/recursos/introduccion>Recursos</a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=/ratings/>Ratings</a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle ps-0 py-1" href=# id=navbarDropdownMenuLink role=button data-bs-toggle=dropdown aria-expanded=false>Gimnasio
<span class=dropdown-caret><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-down"><polyline points="6 9 12 15 18 9"/></svg></span></a><ul class="dropdown-menu dropdown-menu-main shadow rounded border-0" aria-labelledby=navbarDropdownMenuLink><li><a class=dropdown-item href=/gimnasio/lv1/>Básico 1</a></li><li><a class=dropdown-item href=/gimnasio/lv2/>Básico 2</a></li><li><a class=dropdown-item href=/gimnasio/lv3/>Intermedio 1</a></li><li><a class=dropdown-item href=/gimnasio/lv4/>Intermedio 2</a></li></ul></li><li class=nav-item><a class="nav-link ps-0 py-1" href=/equipos/>Equipos</a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=/acerca/>Acerca</a></li></ul><hr class="text-black-50 my-4 d-lg-none"><form class="doks-search position-relative flex-grow-1 ms-lg-auto me-lg-2"><input id=search class="form-control is-search" type=search placeholder="Buscar en la página" aria-label="Buscar en la página" autocomplete=off><div id=suggestions class="shadow bg-white rounded d-none"></div></form><hr class="text-black-50 my-4 d-lg-none"><ul class="nav flex-column flex-lg-row"><li class=nav-item><a class="nav-link social-link" href=https://github.com/progcompuch/apunte><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg><small class="ms-2 d-lg-none">GitHub</small></a></li><li class=nav-item><a class="nav-link social-link" href=https://instagram.com/progcompuch><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentcolor" class="bi bi-instagram" viewBox="0 0 16 16"><path d="M8 0C5.829.0 5.556.01 4.703.048 3.85.088 3.269.222 2.76.42a3.917 3.917.0 00-1.417.923A3.927 3.927.0 00.42 2.76C.222 3.268.087 3.85.048 4.7.01 5.555.0 5.827.0 8.001c0 2.172.01 2.444.048 3.297.04.852.174 1.433.372 1.942.205.526.478.972.923 1.417.444.445.89.719 1.416.923.51.198 1.09.333 1.942.372C5.555 15.99 5.827 16 8 16s2.444-.01 3.298-.048c.851-.04 1.434-.174 1.943-.372a3.916 3.916.0 001.416-.923c.445-.445.718-.891.923-1.417.197-.509.332-1.09.372-1.942C15.99 10.445 16 10.173 16 8s-.01-2.445-.048-3.299c-.04-.851-.175-1.433-.372-1.941a3.926 3.926.0 00-.923-1.417A3.911 3.911.0 0013.24.42c-.51-.198-1.092-.333-1.943-.372C10.443.01 10.172.0 7.998.0h.003zm-.717 1.442h.718c2.136.0 2.389.007 3.232.046.78.035 1.204.166 1.486.275.373.145.64.319.92.599s.453.546.598.92c.11.281.24.705.275 1.485.039.843.047 1.096.047 3.231s-.008 2.389-.047 3.232c-.035.78-.166 1.203-.275 1.485a2.47 2.47.0 01-.599.919c-.28.28-.546.453-.92.598-.28.11-.704.24-1.485.276-.843.038-1.096.047-3.232.047s-2.39-.009-3.233-.047c-.78-.036-1.203-.166-1.485-.276a2.478 2.478.0 01-.92-.598 2.48 2.48.0 01-.6-.92c-.109-.281-.24-.705-.275-1.485-.038-.843-.046-1.096-.046-3.233.0-2.136.008-2.388.046-3.231.036-.78.166-1.204.276-1.486.145-.373.319-.64.599-.92.28-.28.546-.453.92-.598.282-.11.705-.24 1.485-.276.738-.034 1.024-.044 2.515-.045v.002zm4.988 1.328a.96.96.0 100 1.92.96.96.0 000-1.92zm-4.27 1.122a4.109 4.109.0 100 8.217 4.109 4.109.0 000-8.217zm0 1.441a2.667 2.667.0 110 5.334 2.667 2.667.0 010-5.334z"/></svg><small class="ms-2 d-lg-none">Instagram</small></a></li></ul><hr class="text-black-50 my-4 d-lg-none"><button id=mode class="btn btn-link" type=button aria-label="Toggle user interface mode">
<span class=toggle-dark><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></span><span class=toggle-light><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></span></button></div></div></nav></header></div><div class=container-xxl><aside class=doks-sidebar><nav id=doks-docs-nav class="collapse d-lg-none" aria-label="Tertiary navigation"><ul class="list-unstyled collapsible-sidebar"><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-apunte-prologo aria-expanded=false>
Prólogo</button><div class=collapse id=section-apunte-prologo><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/apunte/prologo/introduccion/>Introducción</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-apunte-introduccion aria-expanded=false>
Introducción</button><div class=collapse id=section-apunte-introduccion><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/apunte/introduccion/compilacion_y_editores/>Compilación y editores de texto</a></li><li><a class="docs-link rounded" href=/apunte/introduccion/sintaxis_variables_tipos_ciclos/>Sintaxis, variables, tipos y ciclos</a></li><li><a class="docs-link rounded" href=/apunte/introduccion/funciones/>Funciones</a></li><li><a class="docs-link rounded" href=/apunte/introduccion/vectores/>Vectores</a></li><li><a class="docs-link rounded" href=/apunte/introduccion/operadores_de_bits/>Operadores de bits</a></li><li><a class="docs-link rounded" href=/apunte/introduccion/analisis_de_complejidad/>Análisis de complejidad</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-apunte-libreria_estandar aria-expanded=false>
Librería estándar de C++</button><div class=collapse id=section-apunte-libreria_estandar><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/apunte/libreria_estandar/char_string/>Char y string</a></li><li><a class="docs-link rounded" href=/apunte/libreria_estandar/pair_tuple/>Pair y tuple</a></li><li><a class="docs-link rounded" href=/apunte/libreria_estandar/sort/>Sort</a></li><li><a class="docs-link rounded" href=/apunte/libreria_estandar/set_map_multiset/>Set, map y multiset</a></li><li><a class="docs-link rounded" href=/apunte/libreria_estandar/stack_queue/>Stack y queue</a></li><li><a class="docs-link rounded" href=/apunte/libreria_estandar/priority_queue/>Priority queue</a></li><li class="my-1 ms-3"><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-apunte-libreria_estandar-extras aria-expanded=false>
Extras</button><div class=collapse id=section-apunte-libreria_estandar-extras><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/apunte/libreria_estandar/extras/permutaciones_de_un_arreglo/>Permutaciones de un vector</a></li></ul></div></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-apunte-paradigmas_de_resolucion aria-expanded=false>
Paradigmas de resolución</button><div class=collapse id=section-apunte-paradigmas_de_resolucion><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/apunte/paradigmas_de_resolucion/busqueda_binaria/>Búsqueda binaria</a></li><li><a class="docs-link rounded" href=/apunte/paradigmas_de_resolucion/programacion_dinamica/>Programación dinámica</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-apunte-estructuras_de_datos aria-expanded=false>
Estructuras de datos</button><div class=collapse id=section-apunte-estructuras_de_datos><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/apunte/estructuras_de_datos/union_find/>Union-find</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-apunte-grafos aria-expanded=false>
Grafos</button><div class=collapse id=section-apunte-grafos><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/apunte/grafos/introduccion/>Introducción</a></li><li><a class="docs-link rounded" href=/apunte/grafos/busqueda_en_grafos/>Búsqueda en grafos (BFS y DFS)</a></li><li><a class="docs-link rounded" href=/apunte/grafos/caminos_ciclos_eulerianos/>Caminos y ciclos eulerianos</a></li><li><a class="docs-link rounded" href=/apunte/grafos/minimum_spanning_tree/>Minimum spanning tree</a></li><li><a class="docs-link rounded" href=/apunte/grafos/caminos_mas_cortos/>Caminos más cortos</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-apunte-extras aria-expanded=true>
Extras</button><div class="collapse show" id=section-apunte-extras><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded active" href=/apunte/extras/recurrencias_lineales/>Recurrencias lineales</a></li><li><a class="docs-link rounded" href=/apunte/extras/treaps/>Treaps</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-apunte-geometria aria-expanded=false>
Geometría</button><div class=collapse id=section-apunte-geometria><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/apunte/geometria/puntos/>Puntos</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-apunte-anexos aria-expanded=false>
Anexos</button><div class=collapse id=section-apunte-anexos><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/apunte/anexos/template/>Template</a></li></ul></div></li></ul></nav></aside></div><main class="wrap container-xxl" role=document><div class=content><div class="row flex-xl-nowrap"><div class="col-lg-5 col-xl-4 docs-sidebar d-none d-lg-block"><nav class=docs-links aria-label="Main navigation"><ul class="list-unstyled collapsible-sidebar"><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-apunte-prologo aria-expanded=false>
Prólogo</button><div class=collapse id=section-apunte-prologo><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/apunte/prologo/introduccion/>Introducción</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-apunte-introduccion aria-expanded=false>
Introducción</button><div class=collapse id=section-apunte-introduccion><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/apunte/introduccion/compilacion_y_editores/>Compilación y editores de texto</a></li><li><a class="docs-link rounded" href=/apunte/introduccion/sintaxis_variables_tipos_ciclos/>Sintaxis, variables, tipos y ciclos</a></li><li><a class="docs-link rounded" href=/apunte/introduccion/funciones/>Funciones</a></li><li><a class="docs-link rounded" href=/apunte/introduccion/vectores/>Vectores</a></li><li><a class="docs-link rounded" href=/apunte/introduccion/operadores_de_bits/>Operadores de bits</a></li><li><a class="docs-link rounded" href=/apunte/introduccion/analisis_de_complejidad/>Análisis de complejidad</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-apunte-libreria_estandar aria-expanded=false>
Librería estándar de C++</button><div class=collapse id=section-apunte-libreria_estandar><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/apunte/libreria_estandar/char_string/>Char y string</a></li><li><a class="docs-link rounded" href=/apunte/libreria_estandar/pair_tuple/>Pair y tuple</a></li><li><a class="docs-link rounded" href=/apunte/libreria_estandar/sort/>Sort</a></li><li><a class="docs-link rounded" href=/apunte/libreria_estandar/set_map_multiset/>Set, map y multiset</a></li><li><a class="docs-link rounded" href=/apunte/libreria_estandar/stack_queue/>Stack y queue</a></li><li><a class="docs-link rounded" href=/apunte/libreria_estandar/priority_queue/>Priority queue</a></li><li class="my-1 ms-3"><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-apunte-libreria_estandar-extras aria-expanded=false>
Extras</button><div class=collapse id=section-apunte-libreria_estandar-extras><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/apunte/libreria_estandar/extras/permutaciones_de_un_arreglo/>Permutaciones de un vector</a></li></ul></div></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-apunte-paradigmas_de_resolucion aria-expanded=false>
Paradigmas de resolución</button><div class=collapse id=section-apunte-paradigmas_de_resolucion><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/apunte/paradigmas_de_resolucion/busqueda_binaria/>Búsqueda binaria</a></li><li><a class="docs-link rounded" href=/apunte/paradigmas_de_resolucion/programacion_dinamica/>Programación dinámica</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-apunte-estructuras_de_datos aria-expanded=false>
Estructuras de datos</button><div class=collapse id=section-apunte-estructuras_de_datos><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/apunte/estructuras_de_datos/union_find/>Union-find</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-apunte-grafos aria-expanded=false>
Grafos</button><div class=collapse id=section-apunte-grafos><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/apunte/grafos/introduccion/>Introducción</a></li><li><a class="docs-link rounded" href=/apunte/grafos/busqueda_en_grafos/>Búsqueda en grafos (BFS y DFS)</a></li><li><a class="docs-link rounded" href=/apunte/grafos/caminos_ciclos_eulerianos/>Caminos y ciclos eulerianos</a></li><li><a class="docs-link rounded" href=/apunte/grafos/minimum_spanning_tree/>Minimum spanning tree</a></li><li><a class="docs-link rounded" href=/apunte/grafos/caminos_mas_cortos/>Caminos más cortos</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-apunte-extras aria-expanded=true>
Extras</button><div class="collapse show" id=section-apunte-extras><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded active" href=/apunte/extras/recurrencias_lineales/>Recurrencias lineales</a></li><li><a class="docs-link rounded" href=/apunte/extras/treaps/>Treaps</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-apunte-geometria aria-expanded=false>
Geometría</button><div class=collapse id=section-apunte-geometria><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/apunte/geometria/puntos/>Puntos</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-apunte-anexos aria-expanded=false>
Anexos</button><div class=collapse id=section-apunte-anexos><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=/apunte/anexos/template/>Template</a></li></ul></div></li></ul></nav></div><nav class="docs-toc d-none d-xl-block col-xl-3" aria-label="Secondary navigation"><div class=d-xl-none><button class="btn btn-outline-primary btn-sm doks-toc-toggle collapsed" type=button data-bs-toggle=collapse data-bs-target=#onThisPage aria-controls=doks-docs-nav aria-expanded=false aria-label="Toggle On this page navigation">
<span>Contenidos</span>
<span><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-expand" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Expand</title><polyline points="7 13 12 18 17 13"/><polyline points="7 6 12 11 17 6"/></svg><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-collapse" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Collapse</title><polyline points="17 11 12 6 7 11"/><polyline points="17 18 12 13 7 18"/></svg></span></button><div class=collapse id=onThisPage><div class="card card-body mt-3 py-1"><div class=page-links><nav id=TableOfContents><ul><li><a href=#introducción>Introducción</a><ul><li></li></ul></li></ul><ul><li><a href=#caso-homogéneo><strong>Caso homogéneo</strong></a><ul><li><a href=#dp>DP</a></li><li><a href=#matrices>Matrices</a></li><li><a href=#el-método-kitamasa>El método Kitamasa</a></li></ul></li><li><a href=#caso-no-homogéneo><strong>Caso no Homogéneo</strong></a><ul><li><a href=#caso-fk--b-constante>Caso $f(k) = b$ constante</a></li><li><a href=#caso-fk--pk-polinomio>Caso $f(k) = p(k)$ polinomio</a></li></ul></li></ul></nav></div></div></div></div><div class="page-links d-none d-xl-block"><h3>Contenidos</h3><nav id=TableOfContents><ul><li><a href=#introducción>Introducción</a><ul><li></li></ul></li></ul><ul><li><a href=#caso-homogéneo><strong>Caso homogéneo</strong></a><ul><li><a href=#dp>DP</a></li><li><a href=#matrices>Matrices</a></li><li><a href=#el-método-kitamasa>El método Kitamasa</a></li></ul></li><li><a href=#caso-no-homogéneo><strong>Caso no Homogéneo</strong></a><ul><li><a href=#caso-fk--b-constante>Caso $f(k) = b$ constante</a></li><li><a href=#caso-fk--pk-polinomio>Caso $f(k) = p(k)$ polinomio</a></li></ul></li></ul></nav></div></nav><main class="docs-content col-lg-11 col-xl-9 mx-xl-auto"><h1>Recurrencias lineales</h1><p class=lead></p><nav class=d-xl-none aria-label="Quaternary navigation"><div class=d-xl-none><button class="btn btn-outline-primary btn-sm doks-toc-toggle collapsed" type=button data-bs-toggle=collapse data-bs-target=#onThisPage aria-controls=doks-docs-nav aria-expanded=false aria-label="Toggle On this page navigation">
<span>Contenidos</span>
<span><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-expand" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Expand</title><polyline points="7 13 12 18 17 13"/><polyline points="7 6 12 11 17 6"/></svg><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-collapse" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Collapse</title><polyline points="17 11 12 6 7 11"/><polyline points="17 18 12 13 7 18"/></svg></span></button><div class=collapse id=onThisPage><div class="card card-body mt-3 py-1"><div class=page-links><nav id=TableOfContents><ul><li><a href=#introducción>Introducción</a><ul><li></li></ul></li></ul><ul><li><a href=#caso-homogéneo><strong>Caso homogéneo</strong></a><ul><li><a href=#dp>DP</a></li><li><a href=#matrices>Matrices</a></li><li><a href=#el-método-kitamasa>El método Kitamasa</a></li></ul></li><li><a href=#caso-no-homogéneo><strong>Caso no Homogéneo</strong></a><ul><li><a href=#caso-fk--b-constante>Caso $f(k) = b$ constante</a></li><li><a href=#caso-fk--pk-polinomio>Caso $f(k) = p(k)$ polinomio</a></li></ul></li></ul></nav></div></div></div></div><div class="page-links d-none d-xl-block"><h3>Contenidos</h3><nav id=TableOfContents><ul><li><a href=#introducción>Introducción</a><ul><li></li></ul></li></ul><ul><li><a href=#caso-homogéneo><strong>Caso homogéneo</strong></a><ul><li><a href=#dp>DP</a></li><li><a href=#matrices>Matrices</a></li><li><a href=#el-método-kitamasa>El método Kitamasa</a></li></ul></li><li><a href=#caso-no-homogéneo><strong>Caso no Homogéneo</strong></a><ul><li><a href=#caso-fk--b-constante>Caso $f(k) = b$ constante</a></li><li><a href=#caso-fk--pk-polinomio>Caso $f(k) = p(k)$ polinomio</a></li></ul></li></ul></nav></div></nav><h2 id=introducción>Introducción <a href=#introducci%c3%b3n class=anchor aria-hidden=true>#</a></h2><p>Las recurrencias lineales se ven como secuencias que cumplen una ecuación del tipo:</p><p>$$
a_k = \sum_{i\geq 1} c_i(k)a_{k-i} + f(k)
$$</p><p>Es decir, secuencias donde cada valor depende de una función lineal de los valores anteriores, más alguna función de k.</p><p>Hay un sinfín de variedad de estas, la más clásica de todas siendo:</p><p>$$
f_k = f_{k-1} + f_{k-2}
$$</p><p>La secuencia de Fibonacci. Otra clase de secuencias que podemos expresar usando esta terminología es:
$$
T_n = 2T_{\lceil n/2 \rceil} + O(n)
$$</p><p>El tiempo que nos demoramos en ordenar un arreglo usando Quicksort. Dada la tremenda expresividad de este tipo de ecuaciones, se nos hace difícil poder resolverlas todas y nos vamos a restringir a una clase más acotada de ellas.</p><p>Vamos a decir que una recurrencia es a coeficientes constantes, si es que todos los $ c_i $ cumplen con ser una función constante, esto es, que $ c_i(k) = c_i $ para cada $ i $.</p><p>Y vamos a decir que tiene grado $ n $ si es que la parte lineal tiene exactamente $ n $ términos:</p><p>$$
a_k = \sum_{i=1}^{n} c_i a_{k-i} + f(k)
$$</p><p>Finalmente, diremos que es homogénea si es que $ f(k) = 0 $. Vamos a estudiar primero como resolver recurrencias lineales homogéneas, a coeficientes constantes y de grado finito primero. Luego, veremos algunas clases de recurrencias no homogéneas que también podemos resolver.</p><h4 id=nota-importante-sobre-módulos>Nota Importante sobre módulos <a href=#nota-importante-sobre-m%c3%b3dulos class=anchor aria-hidden=true>#</a></h4><p>Los valores de estas secuencias crecen de forma extremadamente rápida (a velocidad exponencial!). Es por eso que los problemas que nos piden resolver este tipo de recurrencias por lo general las piden módulo un primo grande (nuestro amigo $10^9+7$). Es importante que cuando ustedes programen este tipo de soluciones se fijen en ese detalle, y no intenten programar lo aquí descrito de forma directa (probablemente un gran overflow y un wrong answer).</p><h1 id=recurrencias-lineales-a-coeficientes-constantes-y-de-grado-finito>Recurrencias lineales a coeficientes constantes y de grado finito <a href=#recurrencias-lineales-a-coeficientes-constantes-y-de-grado-finito class=anchor aria-hidden=true>#</a></h1><p>Nos enfocaremos en el caso de las recurrencias más resolubles, es decir, aquellas a coeficientes constantes de grado $n$. Es importante destacar que para poder resolver la recurrencia, necesitamos los primeros $n$ terminos de la secuencia:$a_0, a_1 \dots a_{n-1}$. Esto pues no podemos utilizar la ecuación de recurrencia para determinar el valor de estos terminos, y sin ellos no hay suficiente información para determinar el resto.</p><h2 id=caso-homogéneo><strong>Caso homogéneo</strong> <a href=#caso-homog%c3%a9neo class=anchor aria-hidden=true>#</a></h2><p>Vamos a estudiar técnicas para resolver la recurrencia lineal &ldquo;más simple&rdquo; posible:</p><p>$$
a_k = \sum_{i=1}^{n} c_i a_{k-i}
$$</p><p>La forma más común de atacar este tipo de ecuaciones es a través de estudiar el polinomio característico de la recurrencia, definido como:</p><p>$$
c(\lambda) = \lambda^n - \sum_{i=1}^n c_i \lambda^{n-i}
$$</p><p>Se puede ver que si $ \lambda $ es raíz de este polinomio, entonces la secuencia $ a_k = \lambda^k $ cumple con la recurrencia, y
adicionalmente podemos recuperar todas las soluciones de la recurrencia si es que sabemos todas las raíces del polinomio. No
ahondaremos en este método pues:</p><ol><li>Requiere solucionar polinomios de potencialmente grado $>4$, que no podemos hacer de forma algebraica en todos los casos.</li><li>Aún cuando podemos obtener las raíces, no es fácil obtener la la solución a la recurrencia a partir de ellas, pues o bien
requiere usar números de punto flotante que no es estable númericamente, o requiere usar &ldquo;magia oscura algebraica&rdquo; que es mejor
aplicar mediante otros métodos.</li></ol><p>Veremos 3 métodos de resolver esta ecuación:</p><h3 id=dp>DP <a href=#dp class=anchor aria-hidden=true>#</a></h3><p>Es una aplicación directa de DP generar la solución de estas recurrencias. Usamos:</p><ul><li>$\text{DP}[k] = a_k \ \text{para } k &lt; n $</li><li>$\text{DP}[k] = \sum_{i=1}^n c_i \text{DP}[k-i] $</li></ul><p>Obtenemos una complejidad de $O(NK)$ en tiempo, y $O(K)$ en memoria para obtener la secuencia hasta un $K$ fijo. Esta es la solución más básica y menos optimizada, pero tambien la más fácil de programar. Igual es importante destacar que está es la solución más fácil de extender, pues también sirve para el caso de coeficientes no constantes y recurrencias no homogéneas.</p><details><summary>Código</summary><div class=highlight><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=k>typedef</span> <span class=kt>long</span> <span class=kt>long</span> <span class=n>ll</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=c1>// Trabajar con números de 64 bits 
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=k>const</span> <span class=n>ll</span> <span class=n>MOD</span> <span class=o>=</span> <span class=mf>1e9</span><span class=o>+</span><span class=mi>7</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>%</span> <span class=n>A</span> <span class=n>los</span> <span class=n>casos</span> <span class=n>base</span><span class=p>,</span> <span class=n>C</span> <span class=n>los</span> <span class=n>coeficientes</span>
</span></span><span class=line><span class=cl><span class=n>ll</span> <span class=n>calcular_ak</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>ll</span><span class=o>&gt;</span> <span class=o>&amp;</span><span class=n>a</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=n>ll</span><span class=o>&gt;</span> <span class=o>&amp;</span><span class=n>c</span><span class=p>,</span> <span class=kt>int</span> <span class=n>K</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=n>assert</span><span class=p>(</span><span class=n>a</span><span class=p>.</span><span class=n>size</span><span class=p>()</span> <span class=o>==</span> <span class=n>c</span><span class=p>.</span><span class=n>size</span><span class=p>());</span> 
</span></span><span class=line><span class=cl>  <span class=c1>// Necesitamos tantos casos base como el grado de la recurrencia
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>  <span class=kt>int</span> <span class=n>N</span> <span class=o>=</span> <span class=n>a</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span><span class=p>(</span><span class=n>K</span> <span class=o>&lt;</span> <span class=n>N</span><span class=p>)</span> <span class=k>return</span> <span class=n>a</span><span class=p>[</span><span class=n>K</span><span class=p>];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>vector</span><span class=o>&lt;</span><span class=n>ll</span><span class=o>&gt;</span> <span class=n>DP</span><span class=p>(</span><span class=n>K</span><span class=o>+</span><span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>k</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>k</span> <span class=o>&lt;</span> <span class=n>N</span><span class=p>;</span> <span class=o>++</span><span class=n>k</span><span class=p>)</span> <span class=n>DP</span><span class=p>[</span><span class=n>k</span><span class=p>]</span> <span class=o>=</span> <span class=n>a</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>k</span> <span class=o>=</span> <span class=n>N</span><span class=p>;</span> <span class=n>k</span> <span class=o>&lt;=</span> <span class=n>K</span><span class=p>;</span> <span class=o>++</span><span class=n>k</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>DP</span><span class=p>[</span><span class=n>k</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;=</span> <span class=n>N</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>DP</span><span class=p>[</span><span class=n>k</span><span class=p>]</span> <span class=o>+=</span> <span class=n>c</span><span class=p>[</span><span class=n>i</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span><span class=o>*</span><span class=n>DP</span><span class=p>[</span><span class=n>k</span><span class=o>-</span><span class=n>i</span><span class=p>];</span>
</span></span><span class=line><span class=cl>      <span class=n>DP</span><span class=p>[</span><span class=n>k</span><span class=p>]</span> <span class=o>%=</span> <span class=n>MOD</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=n>DP</span><span class=p>[</span><span class=n>K</span><span class=p>];</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div></details><h3 id=matrices>Matrices <a href=#matrices class=anchor aria-hidden=true>#</a></h3><p>Podemos expresar la recurrencia de forma matricial:</p><p>$$
\begin{pmatrix}
c_1 & c_2 & \cdots & c_n\\
1 & 0 & \cdots & 0 \\
0 & 1 & \cdots & 0 \\
\vdots & \ddots & \ddots & \vdots \\
0 & \cdots & 1 & 0
\end{pmatrix}
\begin{pmatrix}
a_{k-1} \\
a_{k-2} \\
\vdots \\[1.5em]
a_{k-n}
\end{pmatrix} =
\begin{pmatrix}
a_{k} \\
a_{k-1} \\
\vdots \\[1.5em]
a_{k-(n-1)}
\end{pmatrix}
$$</p><p>Llamando $\mathbf{C}$ a esta matriz, y definiendo $\mathbf{a_k} = (a_{k+(n-1)} \dots a_{k+1}, a_{k})^t$, podemos escribir de forma más sucinta:</p><p>$$
\mathbf{C}\mathbf{a_{k-1}} = \mathbf{a_k}
$$</p><p>Que tiene una solución bastante simple para el $k$-ésimo termino:</p><p>$$
\mathbf{a_k} = \mathbf{C^{k}}\mathbf{a_{0}}
$$</p><p>Con lo que podemos rescatar el $k$-ésimo termino de la secuencia elevando la matriz a $k$, y obteniendo $a_k$ a partir de $\mathbf{a_k}$. ¿Cuanto tiempo nos toma calcular esta potencia de matriz? Multiplicar dos matrices de tamaño $N \times N$ nos toma tiempo $O(N^3)$, y utilizando exponenciación rápida podemos calcular la $k$-ésima potencia utilizando $O(\log(K))$ multiplicaciones. En total, utilizamos $O(N^3 \log(K))$ tiempo.</p><p>Esta solución nos será útil solo para alrededor de $N \leq 500$, pero lo importante es que nos permite acceder a valores mucho más grandes de $K$. Valores como $K = 10^{18}$ no son en absoluto un problema para esta técnica.</p><details><summary>Código</summary><p><strong>Código para multiplicar mátrices</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=k>typedef</span> <span class=kt>long</span> <span class=kt>long</span> <span class=n>ll</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>const</span> <span class=n>ll</span> <span class=n>MOD</span> <span class=o>=</span> <span class=mf>1e9</span><span class=o>+</span><span class=mi>7</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>struct</span> <span class=nc>matrix</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>ll</span><span class=o>&gt;&gt;</span> <span class=n>data</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=kt>int</span> <span class=n>n</span><span class=p>,</span> <span class=n>m</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>matrix</span><span class=p>(</span><span class=kt>int</span> <span class=n>n</span><span class=p>,</span> <span class=kt>int</span> <span class=n>m</span><span class=p>)</span> <span class=o>:</span> <span class=n>n</span><span class=p>(</span><span class=n>n</span><span class=p>),</span> <span class=n>m</span><span class=p>(</span><span class=n>m</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>data</span><span class=p>.</span><span class=n>resize</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=n>ll</span><span class=o>&gt;</span><span class=p>(</span><span class=n>m</span><span class=p>,</span> <span class=mi>0</span><span class=p>));</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>vector</span><span class=o>&lt;</span><span class=n>ll</span><span class=o>&gt;</span> <span class=o>&amp;</span><span class=k>operator</span><span class=p>[](</span><span class=kt>int</span> <span class=n>i</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>data</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>ll</span> <span class=nf>access</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span><span class=p>,</span> <span class=kt>int</span> <span class=n>j</span><span class=p>)</span> <span class=k>const</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>data</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>];</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>matrix</span> <span class=k>operator</span><span class=o>*</span><span class=p>(</span><span class=k>const</span> <span class=n>matrix</span> <span class=o>&amp;</span><span class=n>A</span><span class=p>,</span> <span class=k>const</span> <span class=n>matrix</span> <span class=o>&amp;</span><span class=n>B</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=n>assert</span><span class=p>(</span><span class=n>A</span><span class=p>.</span><span class=n>m</span> <span class=o>==</span> <span class=n>B</span><span class=p>.</span><span class=n>n</span><span class=p>);</span> <span class=c1>// Verificar que las dimensiones calcen
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=n>matrix</span> <span class=nf>C</span><span class=p>(</span><span class=n>A</span><span class=p>.</span><span class=n>n</span><span class=p>,</span> <span class=n>B</span><span class=p>.</span><span class=n>m</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>A</span><span class=p>.</span><span class=n>n</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>k</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>k</span> <span class=o>&lt;</span> <span class=n>A</span><span class=p>.</span><span class=n>m</span><span class=p>;</span> <span class=o>++</span><span class=n>k</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>B</span><span class=p>.</span><span class=n>m</span><span class=p>;</span> <span class=o>++</span><span class=n>j</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>C</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>+=</span> <span class=n>A</span><span class=p>.</span><span class=n>access</span><span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=n>k</span><span class=p>)</span><span class=o>*</span><span class=n>B</span><span class=p>.</span><span class=n>access</span><span class=p>(</span><span class=n>k</span><span class=p>,</span> <span class=n>j</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>C</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>%=</span> <span class=n>MOD</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=n>C</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>vector</span><span class=o>&lt;</span><span class=n>ll</span><span class=o>&gt;</span> <span class=k>operator</span><span class=o>*</span><span class=p>(</span><span class=k>const</span> <span class=n>matrix</span> <span class=o>&amp;</span><span class=n>A</span><span class=p>,</span> <span class=k>const</span> <span class=n>vector</span><span class=o>&lt;</span><span class=n>ll</span><span class=o>&gt;</span> <span class=o>&amp;</span><span class=n>x</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=n>assert</span><span class=p>(</span><span class=n>A</span><span class=p>.</span><span class=n>m</span> <span class=o>==</span> <span class=n>x</span><span class=p>.</span><span class=n>size</span><span class=p>());</span>
</span></span><span class=line><span class=cl>  <span class=n>vector</span><span class=o>&lt;</span><span class=n>ll</span><span class=o>&gt;</span> <span class=n>y</span><span class=p>(</span><span class=n>A</span><span class=p>.</span><span class=n>n</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>A</span><span class=p>.</span><span class=n>n</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>A</span><span class=p>.</span><span class=n>m</span><span class=p>;</span> <span class=o>++</span><span class=n>j</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>y</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>+=</span> <span class=n>A</span><span class=p>.</span><span class=n>access</span><span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=n>j</span><span class=p>)</span><span class=o>*</span><span class=n>x</span><span class=p>[</span><span class=n>j</span><span class=p>];</span>
</span></span><span class=line><span class=cl>      <span class=n>y</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>%=</span> <span class=n>MOD</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=n>y</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p><strong>Ahora, código para obtener la secuencia</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=n>matrix</span> <span class=nf>exponenciacion_rapida</span><span class=p>(</span><span class=n>matrix</span> <span class=o>&amp;</span><span class=n>A</span><span class=p>,</span> <span class=n>ll</span> <span class=n>n</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=n>assert</span><span class=p>(</span><span class=n>A</span><span class=p>.</span><span class=n>n</span> <span class=o>==</span> <span class=n>A</span><span class=p>.</span><span class=n>m</span><span class=p>);</span> <span class=c1>// Solo podemos elevar matrices cuadradas
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=n>matrix</span> <span class=n>ans</span><span class=p>(</span><span class=n>A</span><span class=p>.</span><span class=n>n</span><span class=p>,</span> <span class=n>A</span><span class=p>.</span><span class=n>n</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>A</span><span class=p>.</span><span class=n>n</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span> <span class=n>ans</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=c1>// ans es ahora la matriz identidad, o A^0
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>  <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>bit</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=n>bit</span> <span class=o>&lt;=</span> <span class=n>n</span><span class=p>;</span> <span class=n>bit</span> <span class=o>&lt;&lt;=</span> <span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span><span class=p>((</span><span class=n>bit</span><span class=o>&amp;</span><span class=n>n</span><span class=p>)</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>)</span> <span class=n>ans</span> <span class=o>=</span> <span class=n>A</span><span class=o>*</span><span class=n>ans</span><span class=p>;</span> <span class=c1>// Si el k-esimo bit está prendido, multiplicar por A^2^k
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>A</span> <span class=o>=</span> <span class=n>A</span><span class=o>*</span><span class=n>A</span><span class=p>;</span> <span class=c1>// Conseguir la siguiente potencia binaria de A
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=n>ans</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>ll</span> <span class=nf>calcular_ak</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>ll</span><span class=o>&gt;</span> <span class=o>&amp;</span><span class=n>a</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=n>ll</span><span class=o>&gt;</span> <span class=o>&amp;</span><span class=n>c</span><span class=p>,</span> <span class=n>ll</span> <span class=n>K</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=n>assert</span><span class=p>(</span><span class=n>a</span><span class=p>.</span><span class=n>size</span><span class=p>()</span> <span class=o>==</span> <span class=n>c</span><span class=p>.</span><span class=n>size</span><span class=p>());</span> 
</span></span><span class=line><span class=cl>  <span class=c1>// Necesitamos tantos casos base como el grado de la recurrencia
</span></span></span><span class=line><span class=cl><span class=c1></span>  
</span></span><span class=line><span class=cl>  <span class=kt>int</span> <span class=n>N</span> <span class=o>=</span> <span class=n>a</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span><span class=p>(</span><span class=n>K</span> <span class=o>&lt;</span> <span class=n>N</span><span class=p>)</span> <span class=k>return</span> <span class=n>a</span><span class=p>[</span><span class=n>K</span><span class=p>];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>matrix</span> <span class=n>C</span><span class=p>(</span><span class=n>N</span><span class=p>,</span> <span class=n>N</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>C</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=n>c</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>N</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span> <span class=n>C</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>i</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>vector</span><span class=o>&lt;</span><span class=n>ll</span><span class=o>&gt;</span> <span class=n>x</span> <span class=o>=</span> <span class=n>a</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>reverse</span><span class=p>(</span><span class=n>x</span><span class=p>.</span><span class=n>begin</span><span class=p>(),</span> <span class=n>x</span><span class=p>.</span><span class=n>end</span><span class=p>());</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>vector</span><span class=o>&lt;</span><span class=n>ll</span><span class=o>&gt;</span> <span class=n>y</span> <span class=o>=</span> <span class=n>exponenciacion_rapida</span><span class=p>(</span><span class=n>C</span><span class=p>,</span> <span class=n>K</span><span class=p>)</span><span class=o>*</span><span class=n>x</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=n>y</span><span class=p>.</span><span class=n>back</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div></details><h3 id=el-método-kitamasa>El método Kitamasa <a href=#el-m%c3%a9todo-kitamasa class=anchor aria-hidden=true>#</a></h3><p>Los dos métodos anteriores nos permiten atacar recurrencias donde o bien ambos $n$ y $k$ son pequeños, o $n$ es extremadamente pequeño y $k$ puede ser tan grande como deseemos. Vamos a estudiar un último método que nos permitirá resolver recurrencias cuando $n$ es un poco más grande y no es posible aplicar el metodo matricial.</p><p>Una gracia del método matricial es que nos permite calcular $a_k$ usando solamente los primeros $n$ términos, es decir $a_k = \sum_{i=0}^{n-1} d_i(k) a_i$. Podemos intentar lograr esto aplicando la recurrencia repetidas veces. Por ejemplo, para la recurrencia $a_k = 2a_{k-1} + a_{k-2}$ vemos que:</p><p>$$
\begin{matrix}
a_5 & = & 2a_4 + a_3 \\
a_5 & = & 2(2a_3 + a_2) + a_3 & = & 5a_3 + 2a_2 \\
a_5 & = & 5(2a_2 + a_1) + 2a_2 & = & 12a_2 + 5a_1 \\
a_5 & = & 12(2a_1 + a_0) + 5a_1 & = & 29a_1 + 12a_0
\end{matrix}
$$</p><p>En este caso $d_1 = 29$ y $d_0 = 12$. Podemos repensar este método como ir restando $q(a_k - \sum_{i=1}^n c_i a_{k-i}) = 0$ en cada paso para anular el termino lider, algo así como:</p><p>$$
\begin{matrix}
a_5 & = & 2a_4 + a_3 & - & 2(a_4 - 2a_3 - a_2) & = & 5a_3 + 2a_2\\
a_5 & = & 5a_3 + 2a_2 & - & 5(a_3 - 2a_2 - a_1) & = & 12a_2 + 5a_1 \\
a_5 & = & 12a_2 + 5a_1 & - & 12(a_2 - 2a_1 - a_0) & = & 29a_1 + 12a_0 \\
\end{matrix}
$$</p><p>Si miramos un buen rato, este proceso puede recordarnos a otro algoritmo&mldr; ¡de hecho, este proceso es equivalente al proceso de división de polinomios!</p><p>Para formalizar esta relación con polinomios, utilizaremos un poco de magia algebraica. Definiremos una aplicación lineal sobre polinomios mediante $G(x^i) = a_i$. El problema de calcular $a_k$ se reduce, entonces, al problema de calcular $G(x^k)$. ¿Que utilidad tiene $G$? Notar que $G$ cumple una relación interesante con el polinomio característico de la recurrencia:</p><p>$$ \begin{align*}
c(x) &= x^n - \sum_{i=1}^n c_i x^{n-i} \\[1.2em]
G(c) &= a_n - \sum_{i=1}^n c_i a_{n-i} = 0
\end{align*}
$$</p><p>Aún más, dado que la recurrencia se cumple en todos los índices mayores que $n$, podemos afirmar que para $d>0$ se cumple:</p><p>$$
G(x^dc) = a_{n+d} - \sum_{i=1}^nc_ia_{(n+d)-i} = 0
$$</p><p>Y luego, por extensión, tenemos que para cualquier polinomio $p$:</p><p>$$\begin{align*}
p(x) &= \sum_{j=0}^{m} p_j x^j \\
G(pc) &= \sum_{j=0}^m p_jG(x^jc) = 0
\end{align*}$$</p><p>Aquí entra el gran truco: gracias al algoritmo de Euclides, sabemos que existen polinomios $q(x)$ y $r(x)$, de grado $k-n$ y $&lt;n$ respectivamente, tal que podemos escribir:</p><p>$$
x^k = q(x)c(x) + r(x)
$$</p><p>¡Y la gracia es que podemos aplicar $G$ a esta ecuación!</p><p>$$
G(x^k) = G(qc + r) = G(qc) + G(r) = G(r)
$$</p><p>Escrito de forma más formal, se cumple la ecuación:</p><p>$$
G(x^k) = G(x^k \text{ mod } c)
$$</p><p>Cabe destacar que como $x^k \text{ mod } c$ tiene grado $&lt;n$, para calcular $G(r)$ solamente necesitamos aquellos valores de $a_i$ con $i&lt;n$, y estos corresponden a los casos base de nuestra recurrencia. Entonces, el problema se reduce a calcular $x^k \text{ mod } c$. ¿Como podemos hacer esto de forma eficiente? Si aplicamos el algoritmo de Euclides de forma directa, el calculo tomaría alrededor de $k-n$ pasos donde en cada paso tenemos que restar un multiplo de $c$, es decir que en complejidad tomaría $O(N(K-N)) = O(NK)$ pasos. Esto no mejora en nada respecto al primer método.</p><p>La gracia es hacer este calculo de forma más inteligente. Aplicando el algoritmo de exponenciación rápida, podemos calcular $x^k \text{ mod } c$ a partir de $x \text{ mod } c, \ x^2 \text{ mod } c, \ x^4 \text{ mod } c \dots$. Necesitaremos $O(\log(K))$ de estos polinomios, y en cada paso tendremos que obtener el módulo $c$ de un polinomio de grado a lo más $2N$. Aplicando el algoritmo de Euclides de forma directa, esto nos toma en el peor caso tiempo $O(N(2N-N)) = O(N^2)$ pasos, ¡que nos lleva a un algoritmo final con complejidad $O(N^2 \log(K))$ pasos!</p><p>Para concluir, vamos a describir el algoritmo a grandes rasgos:</p><ol><li>Calcular los polinomios $r_d(x) = [x^{2^d} \text{ mod } c]$ para todos los $d \geq 1$ tales que $2^d \leq k$. Complejidad $O(N^2\log(K))$.</li><li>A partir de la descomposición binaria de $k = \sum b_d 2^d$, multiplicar los $r_d(x)$ y aplicar$\text{ mod } c$ para aquellos $d$ donde $b_d = 1$, para obtener $r(x) = [x^k \text{ mod } c]$. Complejidad $O(N^2\log(K))$</li><li>Calcular $G(r)$ para obtener $a_k$. Complejidad $O(N)$.</li></ol><p>Y utilizando todo esto obtenemos un algoritmo de complejidad $O(N^2\log(K))$ para calcular $a_k$. Como último detalle, este algoritmo puede mejorarse aún más a una complejidad de $O(N\log(N)\log(K))$ utilizando técnicas avanzadas de polinomios. Se pueden encontrar más detalles <a href=https://www.pc-arg.com/media/attachment/fft.pdf>aquí</a>.</p><details><summary>Código</summary><p><strong>Código para polinomios</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=k>typedef</span> <span class=kt>long</span> <span class=kt>long</span> <span class=n>ll</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>const</span> <span class=n>ll</span> <span class=n>MOD</span> <span class=o>=</span> <span class=mf>1e9</span><span class=o>+</span><span class=mi>7</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>struct</span> <span class=nc>poly</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=n>vector</span><span class=o>&lt;</span><span class=n>ll</span><span class=o>&gt;</span> <span class=n>coef</span><span class=p>;</span> <span class=c1>// vector de coeficientes
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kt>int</span> <span class=n>n</span><span class=p>;</span> <span class=c1>// El grado del polinomio
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>  <span class=n>poly</span><span class=p>()</span> <span class=o>:</span> <span class=n>n</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>)</span> <span class=p>{}</span> <span class=c1>// Usaremos grado -1 para el polinomio &#34;vacío&#34;
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=n>poly</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>ll</span><span class=o>&gt;</span> <span class=o>&amp;&amp;</span><span class=n>A</span><span class=p>)</span> <span class=o>:</span> <span class=n>coef</span><span class=p>(</span><span class=n>A</span><span class=p>),</span> <span class=n>n</span><span class=p>(</span><span class=n>A</span><span class=p>.</span><span class=n>size</span><span class=p>()</span><span class=o>-</span><span class=mi>1</span><span class=p>)</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>  <span class=n>poly</span><span class=p>(</span><span class=kt>int</span> <span class=n>n</span><span class=p>)</span> <span class=o>:</span> <span class=n>n</span><span class=p>(</span><span class=n>n</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>coef</span><span class=p>.</span><span class=n>resize</span><span class=p>(</span><span class=n>n</span><span class=o>+</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>ll</span> <span class=o>&amp;</span><span class=k>operator</span><span class=p>[](</span><span class=kt>int</span> <span class=n>k</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>coef</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>ll</span> <span class=nf>access</span><span class=p>(</span><span class=kt>int</span> <span class=n>k</span><span class=p>)</span> <span class=k>const</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>coef</span><span class=p>[</span><span class=n>k</span><span class=p>];</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// Asegura que el coeficiente principal no es 0
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=kt>void</span> <span class=nf>fit</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span><span class=p>(</span><span class=o>!</span><span class=n>coef</span><span class=p>.</span><span class=n>empty</span><span class=p>()</span> <span class=o>&amp;&amp;</span> <span class=n>coef</span><span class=p>.</span><span class=n>back</span><span class=p>()</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>coef</span><span class=p>.</span><span class=n>pop_back</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>n</span> <span class=o>=</span> <span class=n>coef</span><span class=p>.</span><span class=n>size</span><span class=p>()</span><span class=o>-</span><span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>ll</span> <span class=nf>eval</span><span class=p>(</span><span class=n>ll</span> <span class=n>x</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>ll</span> <span class=n>ans</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;=</span> <span class=n>n</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>ans</span> <span class=o>+=</span> <span class=n>coef</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=o>*</span><span class=n>y</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=n>ans</span> <span class=o>%=</span> <span class=n>MOD</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=n>y</span> <span class=o>=</span> <span class=n>y</span><span class=o>*</span><span class=n>x</span><span class=o>%</span><span class=n>MOD</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>ans</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>poly</span> <span class=k>operator</span><span class=o>*</span><span class=p>(</span><span class=k>const</span> <span class=n>poly</span> <span class=o>&amp;</span><span class=n>a</span><span class=p>,</span> <span class=k>const</span> <span class=n>poly</span> <span class=o>&amp;</span><span class=n>b</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=n>poly</span> <span class=nf>c</span><span class=p>(</span><span class=n>a</span><span class=p>.</span><span class=n>n</span> <span class=o>+</span> <span class=n>b</span><span class=p>.</span><span class=n>n</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;=</span> <span class=n>a</span><span class=p>.</span><span class=n>n</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;=</span> <span class=n>b</span><span class=p>.</span><span class=n>n</span><span class=p>;</span> <span class=o>++</span><span class=n>j</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>c</span><span class=p>[</span><span class=n>i</span><span class=o>+</span><span class=n>j</span><span class=p>]</span> <span class=o>+=</span> <span class=n>a</span><span class=p>.</span><span class=n>access</span><span class=p>(</span><span class=n>i</span><span class=p>)</span><span class=o>*</span><span class=n>b</span><span class=p>.</span><span class=n>access</span><span class=p>(</span><span class=n>j</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=n>c</span><span class=p>[</span><span class=n>i</span><span class=o>+</span><span class=n>j</span><span class=p>]</span> <span class=o>%=</span> <span class=n>MOD</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>c</span><span class=p>.</span><span class=n>fit</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=n>c</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Calcula b tal que a*b = 1 modulo MOD
</span></span></span><span class=line><span class=cl><span class=c1>// https://en.wikipedia.org/wiki/Modular_multiplicative_inverse
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>ll</span> <span class=nf>modinv</span><span class=p>(</span><span class=n>ll</span> <span class=n>a</span><span class=p>)</span> <span class=p>{</span> 
</span></span><span class=line><span class=cl>  <span class=n>ll</span> <span class=n>r0</span> <span class=o>=</span> <span class=n>a</span><span class=p>,</span> <span class=n>r1</span> <span class=o>=</span> <span class=n>MOD</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>ll</span> <span class=n>s0</span> <span class=o>=</span> <span class=mi>1</span><span class=p>,</span> <span class=n>s1</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>while</span><span class=p>(</span><span class=n>r1</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>ll</span> <span class=n>q</span> <span class=o>=</span> <span class=n>r0</span><span class=o>/</span><span class=n>r1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>ll</span> <span class=n>r</span> <span class=o>=</span> <span class=n>r0</span> <span class=o>-</span> <span class=n>q</span><span class=o>*</span><span class=n>r1</span><span class=p>;</span> <span class=n>r0</span> <span class=o>=</span> <span class=n>r1</span><span class=p>;</span> <span class=n>r1</span> <span class=o>=</span> <span class=n>r</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>ll</span> <span class=n>s</span> <span class=o>=</span> <span class=n>s0</span> <span class=o>-</span> <span class=n>q</span><span class=o>*</span><span class=n>s1</span><span class=p>;</span> <span class=n>s0</span> <span class=o>=</span> <span class=n>s1</span><span class=p>;</span> <span class=n>s1</span> <span class=o>=</span> <span class=n>s</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>(</span><span class=n>s0</span><span class=o>+</span><span class=n>MOD</span><span class=p>)</span><span class=o>%</span><span class=n>MOD</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Modulo usando el algoritmo de Euclides para polinomios
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>poly</span> <span class=k>operator</span><span class=o>%</span><span class=p>(</span><span class=k>const</span> <span class=n>poly</span> <span class=o>&amp;</span><span class=n>a</span><span class=p>,</span> <span class=k>const</span> <span class=n>poly</span> <span class=o>&amp;</span><span class=n>b</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span><span class=p>(</span><span class=n>a</span><span class=p>.</span><span class=n>n</span> <span class=o>&lt;</span> <span class=n>b</span><span class=p>.</span><span class=n>n</span><span class=p>)</span> <span class=k>return</span> <span class=n>a</span><span class=p>;</span> <span class=c1>// Si el grado es menor, el resto es a
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>  <span class=n>poly</span> <span class=n>r</span> <span class=o>=</span> <span class=n>a</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>ll</span> <span class=n>b_lead</span> <span class=o>=</span> <span class=n>b</span><span class=p>.</span><span class=n>access</span><span class=p>(</span><span class=n>b</span><span class=p>.</span><span class=n>n</span><span class=p>),</span> <span class=n>inv_b_lead</span> <span class=o>=</span> <span class=n>modinv</span><span class=p>(</span><span class=n>b_lead</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>k</span> <span class=o>=</span> <span class=n>a</span><span class=p>.</span><span class=n>n</span><span class=p>;</span> <span class=n>k</span> <span class=o>&gt;=</span> <span class=n>b</span><span class=p>.</span><span class=n>n</span><span class=p>;</span> <span class=o>--</span><span class=n>k</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>ll</span> <span class=n>scale_factor</span> <span class=o>=</span> <span class=p>(</span><span class=n>r</span><span class=p>[</span><span class=n>k</span><span class=p>]</span><span class=o>*</span><span class=n>inv_b_lead</span><span class=p>)</span><span class=o>%</span><span class=n>MOD</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;=</span> <span class=n>b</span><span class=p>.</span><span class=n>n</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>r</span><span class=p>[</span><span class=n>k</span><span class=o>-</span><span class=n>i</span><span class=p>]</span> <span class=o>-=</span> <span class=n>scale_factor</span><span class=o>*</span><span class=n>b</span><span class=p>.</span><span class=n>access</span><span class=p>(</span><span class=n>b</span><span class=p>.</span><span class=n>n</span><span class=o>-</span><span class=n>i</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=n>r</span><span class=p>[</span><span class=n>k</span><span class=o>-</span><span class=n>i</span><span class=p>]</span> <span class=o>%=</span> <span class=n>MOD</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=k>if</span><span class=p>(</span><span class=n>r</span><span class=p>[</span><span class=n>k</span><span class=o>-</span><span class=n>i</span><span class=p>]</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=p>)</span> <span class=n>r</span><span class=p>[</span><span class=n>k</span><span class=o>-</span><span class=n>i</span><span class=p>]</span> <span class=o>+=</span> <span class=n>MOD</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>r</span><span class=p>.</span><span class=n>fit</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=n>r</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p><strong>Código para obtener la secuencia</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=n>poly</span> <span class=nf>exponenciacion_rapida</span><span class=p>(</span><span class=n>poly</span> <span class=o>&amp;</span><span class=n>p</span><span class=p>,</span> <span class=n>poly</span> <span class=o>&amp;</span><span class=n>mod</span><span class=p>,</span> <span class=n>ll</span> <span class=n>n</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// ans inicia como el polinomio unidad i.e. ans(x) = 1
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=n>poly</span> <span class=n>ans</span><span class=p>(</span><span class=mi>0</span><span class=p>);</span> <span class=n>ans</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> 
</span></span><span class=line><span class=cl>  <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>bit</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=n>bit</span> <span class=o>&lt;=</span> <span class=n>n</span><span class=p>;</span> <span class=n>bit</span> <span class=o>&lt;&lt;=</span> <span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span><span class=p>((</span><span class=n>bit</span><span class=o>&amp;</span><span class=n>n</span><span class=p>)</span> <span class=o>!=</span> <span class=mi>0</span><span class=p>)</span> <span class=n>ans</span> <span class=o>=</span> <span class=p>(</span><span class=n>p</span><span class=o>*</span><span class=n>ans</span><span class=p>)</span><span class=o>%</span><span class=n>mod</span><span class=p>;</span> <span class=c1>// Si el k-esimo bit está prendido, multiplicar por p^2^k
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>p</span> <span class=o>=</span> <span class=n>p</span><span class=o>*</span><span class=n>p</span><span class=o>%</span><span class=n>mod</span><span class=p>;</span> <span class=c1>// Conseguir la siguiente potencia binaria de p
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=n>ans</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>ll</span> <span class=nf>G</span><span class=p>(</span><span class=k>const</span> <span class=n>vector</span><span class=o>&lt;</span><span class=n>ll</span><span class=o>&gt;</span> <span class=o>&amp;</span><span class=n>a</span><span class=p>,</span> <span class=k>const</span> <span class=n>poly</span> <span class=o>&amp;</span><span class=n>p</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=n>ll</span> <span class=n>ans</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>k</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>k</span> <span class=o>&lt;=</span> <span class=n>p</span><span class=p>.</span><span class=n>n</span><span class=p>;</span> <span class=o>++</span><span class=n>k</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>ans</span> <span class=o>+=</span> <span class=n>a</span><span class=p>[</span><span class=n>k</span><span class=p>]</span><span class=o>*</span><span class=n>p</span><span class=p>.</span><span class=n>access</span><span class=p>(</span><span class=n>k</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>ans</span> <span class=o>%=</span> <span class=n>MOD</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=n>ans</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>ll</span> <span class=nf>calcular_ak</span><span class=p>(</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>ll</span><span class=o>&gt;</span> <span class=o>&amp;</span><span class=n>a</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=n>ll</span><span class=o>&gt;</span> <span class=o>&amp;</span><span class=n>c</span><span class=p>,</span> <span class=n>ll</span> <span class=n>K</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=n>assert</span><span class=p>(</span><span class=n>a</span><span class=p>.</span><span class=n>size</span><span class=p>()</span> <span class=o>==</span> <span class=n>c</span><span class=p>.</span><span class=n>size</span><span class=p>());</span> 
</span></span><span class=line><span class=cl>  <span class=c1>// Necesitamos tantos casos base como el grado de la recurrencia
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>  <span class=kt>int</span> <span class=n>N</span> <span class=o>=</span> <span class=n>a</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span><span class=p>(</span><span class=n>K</span> <span class=o>&lt;</span> <span class=n>N</span><span class=p>)</span> <span class=k>return</span> <span class=n>a</span><span class=p>[</span><span class=n>K</span><span class=p>];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>poly</span> <span class=n>p</span><span class=p>(</span><span class=n>N</span><span class=p>);</span> <span class=c1>// Creamos el polinomio característico de la recurrencia
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>  <span class=n>p</span><span class=p>[</span><span class=n>N</span><span class=p>]</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;=</span> <span class=n>N</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span> <span class=n>p</span><span class=p>[</span><span class=n>N</span><span class=o>-</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>MOD</span><span class=o>-</span><span class=n>c</span><span class=p>[</span><span class=n>i</span><span class=o>-</span><span class=mi>1</span><span class=p>];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>poly</span> <span class=n>x</span><span class=p>(</span><span class=mi>1</span><span class=p>);</span> <span class=n>x</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=c1>// El polinomio base x
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=k>return</span> <span class=n>G</span><span class=p>(</span><span class=n>a</span><span class=p>,</span> <span class=n>exponenciacion_rapida</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>p</span><span class=p>,</span> <span class=n>K</span><span class=p>));</span> <span class=c1>// Calcular G(x^k mod p)
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span></code></pre></div></details><h2 id=caso-no-homogéneo><strong>Caso no Homogéneo</strong> <a href=#caso-no-homog%c3%a9neo class=anchor aria-hidden=true>#</a></h2><p>Hasta ahora tenemos una gran estructura para lidiar con el caso homogéneo de las recurrencias, pero no sabemos nada respecto a enfrentar recurrencias que no son homogéneas. Veremos dos casos donde es posible reducir estas recurrencias a otras equivalentes que si son homogéneas, que nos permitirá usar todos los métodos ya explicados.</p><h3 id=caso-fk--b-constante>Caso $f(k) = b$ constante <a href=#caso-fk--b-constante class=anchor aria-hidden=true>#</a></h3><p>Estás son las recurrencias lineales no homogéneas más simples posibles. Se ven de la forma:</p><p>$$
a_k = \sum_{i=1}^{n} c_i a_{k-i} + b
$$</p><p>Usando un truco parecido al del método Kitamasa, podemos restar un $0$ conveniente de la forma $0 = -a_{k-1} + \sum_{i=1}^n c_ia_{(k-1)-i} + b$. Para facilitar la notación, diremos que $c_0 = -1$ para poder escribir esta expresión como $0 = \sum_{i=0}^n c_ia_{(k-1)-i} + b$ y lo restaremos:</p><p>$$
\begin{align*}
a_k &= \sum_{i=1}^{n} c_i a_{k-i} + b - \left[\sum_{i=0}^n c_ia_{(k-1)-i} + b\right] \\
&= \sum_{i=1}^{n} c_i a_{k-i} - \sum_{i=0}^n c_ia_{(k-1)-i}
\end{align*}
$$</p><p>Con lo que anulamos $b$ y obtenemos una recurrencia lineal homógenea para $a$. Agrupando terminos, y tomando la convención de que $c_{n+1} = 0$, podemos reescribir esta recurrencia como:</p><p>$$
\hat{c}_i = c_i - c_{i-1} \\
a_k = \sum_{i=1}^{n+1} \hat{c}<em>i a</em>{k-i}
$$</p><p>Notar que mediante este proceso, creamos una recurrencia homogénea de grado $n+1$ a partir de una no homogénea de grado $n$, por lo que necesitaremos calcular un caso base adicional para resolver esta recurrencia. Podemos calcular a partir de los casos base originales y utilizando la recurrencia original.</p><details><summary>Código</summary><div class=highlight><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=k>typedef</span> <span class=kt>long</span> <span class=kt>long</span> <span class=n>ll</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>const</span> <span class=n>ll</span> <span class=n>MOD</span> <span class=o>=</span> <span class=mf>1e9</span><span class=o>+</span><span class=mi>7</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=nf>convert</span><span class=p>(</span><span class=kt>int</span> <span class=o>&amp;</span><span class=n>n</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=n>ll</span><span class=o>&gt;</span> <span class=o>&amp;</span><span class=n>a</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=n>ll</span><span class=o>&gt;</span> <span class=o>&amp;</span><span class=n>c</span><span class=p>,</span> <span class=n>ll</span> <span class=n>b</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=n>assert</span><span class=p>(</span><span class=n>a</span><span class=p>.</span><span class=n>size</span><span class=p>()</span> <span class=o>==</span> <span class=n>n</span> <span class=o>&amp;&amp;</span> <span class=n>c</span><span class=p>.</span><span class=n>size</span><span class=p>()</span> <span class=o>==</span> <span class=n>n</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// Agregamos un caso base adicional
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=n>a</span><span class=p>.</span><span class=n>push_back</span><span class=p>(</span><span class=n>b</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;=</span> <span class=n>n</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>a</span><span class=p>[</span><span class=n>n</span><span class=p>]</span> <span class=o>+=</span> <span class=n>c</span><span class=p>[</span><span class=n>i</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span><span class=o>*</span><span class=n>a</span><span class=p>[</span><span class=n>n</span><span class=o>-</span><span class=n>i</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=n>a</span><span class=p>[</span><span class=n>n</span><span class=p>]</span> <span class=o>%=</span> <span class=n>MOD</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// Computamos los nuevos coeficientes c_i
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=n>c</span><span class=p>.</span><span class=n>push_back</span><span class=p>(</span><span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=n>n</span><span class=p>;</span> <span class=n>i</span> <span class=o>&gt;=</span> <span class=mi>1</span><span class=p>;</span> <span class=o>--</span><span class=n>i</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>c</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>-=</span> <span class=n>c</span><span class=p>[</span><span class=n>i</span><span class=o>-</span><span class=mi>1</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span><span class=p>(</span><span class=n>c</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=p>)</span> <span class=n>c</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>+=</span> <span class=n>MOD</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>c</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=n>c</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>+</span><span class=mi>1</span><span class=p>)</span><span class=o>%</span><span class=n>MOD</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=o>++</span><span class=n>n</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div></details><h3 id=caso-fk--pk-polinomio>Caso $f(k) = p(k)$ polinomio <a href=#caso-fk--pk-polinomio class=anchor aria-hidden=true>#</a></h3><p>Podemos generalizar la técnica anterior para polinomios arbitrarios de la forma $p(k) = \sum_{j=0}^m p_j k^j$. En este caso queremos resolver la recurrencia:</p><p>$$
a_k = \sum_{i=1}^{n} c_i a_{k-i} + p(k)
$$</p><p>Vamos a aplicar iterativamente el truco de restar un $0$ conveniente. Usaremos el hecho de que $q(x) = p(x) - p(x-1)$ es un polinomio de grado $m-1$. Utilizaremos la notación $[x^j]p(x)$ para referirnos al coeficiente que acompaña a $x^j$ en el polinomio $p(x)$, y vemos que:</p><p>$$
\begin{matrix}
[x^m]p(x-1) = [x^m]p(x) \Rightarrow [x^m]q(x) = 0 \\[1.5em]
[x^{m-1}]q(x) = [x^{m-1}](p(x) - p(x-1)) \\[1.5em]
= m[x^m]p(x) + [x^{m-1}]p(x) - [x^{m-1}]p(x) = m[x^m]p(x) \neq 0
\end{matrix}
$$</p><p>Entonces, cuando restamos nuestro $0$ conveniente $0 = \sum_{i=0}^n c_ia_{(k-1)-i} + p(k)$, tenemos que:</p><p>$$
\begin{align*}
a_k &= \sum_{i=1}^{n} c_i a_{k-i} + p(k) - \left[\sum_{i=0}^n c_ia_{(k-1)-i} + p(k-1)\right] \\
&= \sum_{i=1}^{n} c_i a_{k-i} - \sum_{i=0}^n c_ia_{(k-1)-i} + \left[p(k) - p(k-1)\right] \\
&= \sum_{i=1}^{n+1} (c_i-c_{i-1}) a_{k-i} + q(k)
\end{align*}
$$</p><p>Ojo que aquí también estamos usando la convención de que $c_0 = -1$ y $c_{n+1} = 0$. Con este procedimiento, obtenemos una recurrencia lineal no homogénea de grado $n+1$ <em>con un polinomio $q$ de grado $m-1$</em>. Es decir que podemos reducir el grado del polinomio en $1$ aumentando el grado de la recurrencia en $1$. Si repetimos este proceso en total $m+1$ veces, obtendremos una recurrencia lineal de grado $n+m+1$ donde el polinomio se anula <strong>por completo</strong>, osea, homogénea. Al finalizar, obtendremos coeficientes $\hat{c}_i$ tal que:</p><p>$$
a_k = \sum_{i=1}^{n+m+1} \hat{c}<em>i a</em>{k-i}
$$</p><p>Tomando la convención de que $c_i = 0$ para $i &lt; 0$, podemos escribir una formula explícita para los $\hat{c}_i$:</p><p>$$
\hat{c}_i = \sum_{j=0}^{m+1} (-1)^j \binom{m+1}{j}c_j
$$</p><p>De nuevo, es importante recalcar que para poder resolver esta recurrencia con los métodos que conocemos para recurrencias lineales homogéneas, necesitaremos $m+1$ valores adicionales de la secuencia como base, que podemos obtener utilizando la recurrencia original.</p><details><summary>Código</summary><div class=highlight><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=k>typedef</span> <span class=kt>long</span> <span class=kt>long</span> <span class=n>ll</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>const</span> <span class=n>ll</span> <span class=n>MOD</span> <span class=o>=</span> <span class=mf>1e9</span><span class=o>+</span><span class=mi>7</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=nf>convert</span><span class=p>(</span><span class=kt>int</span> <span class=o>&amp;</span><span class=n>n</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=n>ll</span><span class=o>&gt;</span> <span class=o>&amp;</span><span class=n>a</span><span class=p>,</span> <span class=n>vector</span><span class=o>&lt;</span><span class=n>ll</span><span class=o>&gt;</span> <span class=o>&amp;</span><span class=n>c</span><span class=p>,</span> <span class=n>poly</span> <span class=o>&amp;</span><span class=n>p</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=n>assert</span><span class=p>(</span><span class=n>a</span><span class=p>.</span><span class=n>size</span><span class=p>()</span> <span class=o>==</span> <span class=n>n</span> <span class=o>&amp;&amp;</span> <span class=n>c</span><span class=p>.</span><span class=n>size</span><span class=p>()</span> <span class=o>==</span> <span class=n>n</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kt>int</span> <span class=n>m</span> <span class=o>=</span> <span class=n>p</span><span class=p>.</span><span class=n>n</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=c1>// Debemos agregar m+1 casos base
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>k</span> <span class=o>=</span> <span class=n>n</span><span class=p>;</span> <span class=n>k</span> <span class=o>&lt;=</span> <span class=n>n</span><span class=o>+</span><span class=n>m</span><span class=p>;</span> <span class=o>++</span><span class=n>k</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>a</span><span class=p>.</span><span class=n>push_back</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=n>eval</span><span class=p>(</span><span class=n>k</span><span class=p>));</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;=</span> <span class=n>n</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>a</span><span class=p>[</span><span class=n>k</span><span class=p>]</span> <span class=o>+=</span> <span class=n>c</span><span class=p>[</span><span class=n>i</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span><span class=o>*</span><span class=n>a</span><span class=p>[</span><span class=n>k</span><span class=o>-</span><span class=n>i</span><span class=p>];</span>
</span></span><span class=line><span class=cl>      <span class=n>a</span><span class=p>[</span><span class=n>k</span><span class=p>]</span> <span class=o>%=</span> <span class=n>MOD</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1>// Computamos los nuevos coeficientes c_i
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>k</span> <span class=o>=</span> <span class=n>n</span><span class=p>;</span> <span class=n>k</span> <span class=o>&lt;=</span> <span class=n>n</span><span class=o>+</span><span class=n>m</span><span class=p>;</span> <span class=o>++</span><span class=n>k</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>c</span><span class=p>.</span><span class=n>push_back</span><span class=p>(</span><span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>for</span><span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=n>k</span><span class=p>;</span> <span class=n>i</span> <span class=o>&gt;=</span> <span class=mi>1</span><span class=p>;</span> <span class=o>--</span><span class=n>i</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=n>c</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>-=</span> <span class=n>c</span><span class=p>[</span><span class=n>i</span><span class=o>-</span><span class=mi>1</span><span class=p>];</span>
</span></span><span class=line><span class=cl>      <span class=k>if</span><span class=p>(</span><span class=n>c</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=p>)</span> <span class=n>c</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>+=</span> <span class=n>MOD</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>c</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=n>c</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>+</span><span class=mi>1</span><span class=p>)</span><span class=o>%</span><span class=n>MOD</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>n</span> <span class=o>+=</span> <span class=n>m</span><span class=o>+</span><span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div></details><div class="page-footer-meta d-flex flex-column flex-md-row justify-content-between"></div><div class="docs-navigation d-flex justify-content-between"><a class=ms-auto href=/apunte/extras/treaps/><div class="card my-1"><div class="card-body py-2">Treaps &rarr;</div></div></a></div></main></div></div></main><footer class="footer text-muted"><div class=container-xxl><div class=row><div class="col-lg-8 order-last order-lg-first"><ul class=list-inline><li class=list-inline-item>Sitio generado con <a href=https://gohugo.io/>Hugo</a> y <a href=https://getdoks.org/>Doks</a></li></ul></div><div class="col-lg-8 order-first order-lg-last text-lg-end"><ul class=list-inline></ul></div></div></div></footer><script src=/js/bootstrap.min.650aeec64c81d69d4c0850fc73c93da3f0330cec0a27772feed7f90f60baa5f47f1c45687d71914bdafd1c4e860d40f6dc08ede27a2f08431ff929c9a2d24621.js integrity="sha512-ZQruxkyB1p1MCFD8c8k9o/AzDOwKJ3cv7tf5D2C6pfR/HEVofXGRS9r9HE6GDUD23Ajt4novCEMf+SnJotJGIQ==" crossorigin=anonymous defer></script>
<script src=/js/highlight.min.3f0a703c54cbed82ca277187e23cf2d272da28c15ce7e33cde685d40b53d741893d5b74d35bb2d20a81f56c289084f245bdd0c9145d39d7094d3dfbc62d1326a.js integrity="sha512-PwpwPFTL7YLKJ3GH4jzy0nLaKMFc5+M83mhdQLU9dBiT1bdNNbstIKgfVsKJCE8kW90MkUXTnXCU09+8YtEyag==" crossorigin=anonymous defer></script>
<script src=/js/vendor/katex/dist/katex.min.4a130545cfa0b145956b188947be680113c0368d83dc6e8957d7cb99b4aa95f507169eb70a45b618628dd68d305da05dc4dee3958464b33c112ec1047e4ec2c2.js integrity="sha512-ShMFRc+gsUWVaxiJR75oARPANo2D3G6JV9fLmbSqlfUHFp63CkW2GGKN1o0wXaBdxN7jlYRkszwRLsEEfk7Cwg==" crossorigin=anonymous defer></script>
<script src=/js/vendor/katex/dist/contrib/auto-render.min.f128dc24877a8ff5cdc694570f6cd25f8ad512d4330c242487c4cbbc5dc6fd2c52de778da1e59f98585d1defd5aa5aa583da59e90e6837973ecca3b45b01fb64.js integrity="sha512-8SjcJId6j/XNxpRXD2zSX4rVEtQzDCQkh8TLvF3G/SxS3neNoeWfmFhdHe/Vqlqlg9pZ6Q5oN5c+zKO0WwH7ZA==" crossorigin=anonymous defer></script>
<script src=/main.min.9964467df4194d792cb58ca9520e3b958f84c6fc20f1052932f3ce7b2cfcde3f7e4b256c8b69c7b19f38b0d7dd2d77d9f3c1f8aea88ab301c04554225cc34789.js integrity="sha512-mWRGffQZTXkstYypUg47lY+Exvwg8QUpMvPOeyz83j9+SyVsi2nHsZ84sNfdLXfZ88H4rqiKswHARVQiXMNHiQ==" crossorigin=anonymous defer></script>
<script src=/index.min.4ae26272486ea46c5bb0bed7a0b434a91b05e8182cfb839a405dd4e647b05ce5d76d401a5103d822d3b1589fc56335cd372b712d97085b8d89aebf244b1b5501.js integrity="sha512-SuJickhupGxbsL7XoLQ0qRsF6Bgs+4OaQF3U5kewXOXXbUAaUQPYItOxWJ/FYzXNNytxLZcIW42Jrr8kSxtVAQ==" crossorigin=anonymous defer></script></body></html>