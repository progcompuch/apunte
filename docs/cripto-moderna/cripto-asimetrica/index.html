<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=preload as=font href=/fonts/vendor/jost/jost-v4-latin-regular.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=/fonts/vendor/jost/jost-v4-latin-700.woff2 type=font/woff2 crossorigin><link rel=stylesheet href=/main.ea4d744ed3e994ed192382639302aa6523cc0430fcfb03c36079cd4b4b5ca5295b73292b40f5dd53ef30bf72bde5235c49558cc3ed58f260d349563a7e8bd524.css integrity="sha512-6k10TtPplO0ZI4JjkwKqZSPMBDD8+wPDYHnNS0tcpSlbcykrQPXdU+8wv3K95SNcSVWMw+1Y8mDTSVY6fovVJA==" crossorigin=anonymous><noscript><style>img.lazyload{display:none}</style></noscript><meta name=robots content="index, follow"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><title>Criptografía Asimétrica - Taller de Hacking Competitivo</title><meta name=description content="DCC universidad de Chile"><link rel=canonical href=/docs/cripto-moderna/cripto-asimetrica/><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="/logo_redondo.png"><meta name=twitter:title content="Criptografía Asimétrica"><meta name=twitter:description content="La criptografía asimétrica o criptografía de llave pública se diferencia de la criptografía simétrica en que se usan llaves distintas para cifrar y descifrar mensajes, lo que hace posible publicar la llave de cifrado con el objetivo de que otras personas puedan enviarnos mensajes que solo nosotros podremos descifrar, usando la llave de descifrado. Algo similar ocurre con la criptografía asimétrica usada para firmas digitales. Se usa una llave para &ldquo;demostrar&rdquo; que un mensaje fue enviado por nosotros mientras se publica la otra para que cualquiera pueda comprobar que la firma es válida."><meta name=twitter:site content="@dccuchile"><meta name=twitter:creator content="@dccuchile"><meta property="og:title" content="Criptografía Asimétrica"><meta property="og:description" content="La criptografía asimétrica o criptografía de llave pública se diferencia de la criptografía simétrica en que se usan llaves distintas para cifrar y descifrar mensajes, lo que hace posible publicar la llave de cifrado con el objetivo de que otras personas puedan enviarnos mensajes que solo nosotros podremos descifrar, usando la llave de descifrado. Algo similar ocurre con la criptografía asimétrica usada para firmas digitales. Se usa una llave para &ldquo;demostrar&rdquo; que un mensaje fue enviado por nosotros mientras se publica la otra para que cualquiera pueda comprobar que la firma es válida."><meta property="og:type" content="article"><meta property="og:url" content="/docs/cripto-moderna/cripto-asimetrica/"><meta property="og:image" content="/logo_redondo.png"><meta property="article:published_time" content="2020-10-06T08:48:45+00:00"><meta property="article:modified_time" content="2021-04-13T04:02:37+00:00"><meta property="og:site_name" content="Taller de Hacking Competitivo"><meta property="article:publisher" content="https://www.facebook.com/DCCUChile"><meta property="article:author" content="https://www.facebook.com/DCCUChile"><meta property="og:locale" content="es_CL"><script type=application/ld+json>{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"\/"},{"@type":"ListItem","position":2,"name":"Docscripto Modernacripto Asimetrica","item":"\/docscripto-modernacripto-asimetrica\/"}]}</script><meta name=theme-color content="#fff"><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest></head><body class="docs single"><div class="header-bar fixed-top"></div><header class="navbar fixed-top navbar-expand-md navbar-light"><div class=container><input class="menu-btn order-0" type=checkbox id=menu-btn>
<label class="menu-icon d-md-none" for=menu-btn><span class=navicon></span></label><a class="navbar-brand order-1 order-md-0 mr-auto" href=/><img class=logo-light src=/images/banner.svg></img>
<img class=logo-dark src=/images/banner_dark.svg></img></a>
<button id=mode class="btn btn-link order-2 order-md-4" type=button aria-label="Toggle mode">
<span class=toggle-dark><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></span><span class=toggle-light><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></span></button><ul class="navbar-nav social-nav order-3 order-md-5"><li class=nav-item><a class=nav-link href=https://github.com/cc5325/apunte><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77a5.44 5.44.0 00-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg><span class="ml-2 sr-only">GitHub</span></a></li></ul><div class="collapse navbar-collapse order-4 order-md-1"><ul class="navbar-nav main-nav mr-auto order-5 order-md-2"><li class=nav-item><a class=nav-link href=/blog/>Videos</a></li><li class=nav-item><a class=nav-link href=/docs/prologo/intro>Apunte</a></li><li class=nav-item><a class=nav-link href=/writeups/misc/registro_htb>Writeups</a></li><li class=nav-item><a class=nav-link href=/acerca>Acerca</a></li></ul><div class="break order-6 d-md-none"></div><form class="navbar-form flex-grow-1 order-7 order-md-3"><input id=userinput class="form-control is-search" type=search placeholder="Buscar Documentación..." aria-label="Buscar Documentación..." autocomplete=off><div id=suggestions class="shadow bg-white rounded"></div></form></div></div></header><div class="wrap container" role=document><div class=content><div class="row flex-xl-nowrap"><div class="col-lg-5 col-xl-4 docs-sidebar"><nav class=docs-links aria-label="Main navigation"><h3>Prólogo</h3><ul class=list-unstyled><li><a class=docs-link href=/docs/prologo/intro/>Prólogo</a></li></ul><h3>Esteganografía</h3><ul class=list-unstyled><li><a class=docs-link href=/docs/stego/stego/>Stego en texto, imágenes y audio</a></li><li><a class=docs-link href=/docs/stego/intro/>Intro a la Esteganografía</a></li><li><a class=docs-link href=/docs/stego/ejercicios/>Ejercicios de Stego</a></li><li><a class=docs-link href=/docs/stego/cripto-clasica/>Criptografía Clásica</a></li><li><a class=docs-link href=/docs/stego/conceptos-basicos/>Conceptos Básicos</a></li></ul><h3>Criptografía Moderna</h3><ul class=list-unstyled><li><a class=docs-link href=/docs/cripto-moderna/intro/>Intro a Criptografía Moderna</a></li><li><a class=docs-link href=/docs/cripto-moderna/hashing/>Hashing</a></li><li><a class=docs-link href=/docs/cripto-moderna/ejercicios/>Ejercicios Cripto Moderna</a></li><li><a class=docs-link href=/docs/cripto-moderna/cripto-simetrica/>Criptografía Simétrica</a></li><li><a class="docs-link active" href=/docs/cripto-moderna/cripto-asimetrica/>Criptografía Asimétrica</a></li></ul><h3>Aplicaciones Web</h3><ul class=list-unstyled><li><a class=docs-link href=/docs/apps-web/xss/>Cross-Site Scripting</a></li><li><a class=docs-link href=/docs/apps-web/tecnicas-basicas/>Técnicas Básicas de Análisis Web</a></li><li><a class=docs-link href=/docs/apps-web/reverse-shell/>Reverse Shell</a></li><li><a class=docs-link href=/docs/apps-web/rce/>Remote Code Execution</a></li><li><a class=docs-link href=/docs/apps-web/inyecciones/>Inyecciones</a></li><li><a class=docs-link href=/docs/apps-web/intro/>Intro a Aplicaciones Web</a></li><li><a class=docs-link href=/docs/apps-web/ejercicios/>Ejercicios Apps Web</a></li><li><a class=docs-link href=/docs/apps-web/cve/>Common Vulnerabilities and Exposures</a></li></ul><h3>Análisis Forense</h3><ul class=list-unstyled><li><a class=docs-link href=/docs/forense/intro/>Intro al Análisis Forense</a></li></ul><h3>Ingeniería Reversa</h3><ul class=list-unstyled><li><a class=docs-link href=/docs/reversa/intro/>Intro a la Ingeniería Reversa</a></li><li><a class=docs-link href=/docs/reversa/ejercicios/>Ejercicios Reversing</a></li><li><a class=docs-link href=/docs/reversa/deobfuscation/>Deobfuscación de Binarios</a></li><li><a class=docs-link href=/docs/reversa/decompiling/>Decompilación</a></li></ul><h3>Pwning</h3><ul class=list-unstyled><li><a class=docs-link href=/docs/pwning/intro/>Intro al Pwning</a></li></ul><h3>OSINT</h3><ul class=list-unstyled><li><a class=docs-link href=/docs/osint/theharvester/>The Harvester</a></li><li><a class=docs-link href=/docs/osint/shodan/>Shodan</a></li><li><a class=docs-link href=/docs/osint/intro/>Intro a OSINT</a></li><li><a class=docs-link href=/docs/osint/haveibeenpwned/>Have I Been Pwned</a></li><li><a class=docs-link href=/docs/osint/google/>Google Hacking</a></li><li><a class=docs-link href=/docs/osint/github/>Búsqueda en Github</a></li></ul><h3>Anexos</h3><ul class=list-unstyled><li><a class=docs-link href=/docs/anexos/vpn/>Configuración de VPN</a></li><li><a class=docs-link href=/docs/anexos/referencias/>Referencias</a></li><li><a class=docs-link href=/docs/anexos/proxy/>Proxy</a></li><li><a class=docs-link href=/docs/anexos/kali/>Kali Linux</a></li><li><a class=docs-link href=/docs/anexos/herramientas/>Herramientas</a></li><li><a class=docs-link href=/docs/anexos/comandos/>Comandos de Terminal de Linux</a></li></ul></nav></div><nav class="docs-toc d-none d-xl-block col-xl-3" aria-label="Secondary navigation"><div class=page-links><h3>Contenidos</h3><nav id=TableOfContents><ul><li><a href=#rsa>RSA</a><ul><li><a href=#cifrado>Cifrado</a></li><li><a href=#firmas>Firmas</a></li></ul></li><li><a href=#acuerdo-de-llaves-diffie-hellman>Acuerdo de llaves Diffie-Hellman</a><ul><li><a href=#problemas-de-seguridad-dh>Problemas de seguridad DH</a></li></ul></li><li><a href=#criptografía-de-curvas-elípticas>Criptografía de Curvas Elípticas</a></li></ul></nav></div></nav><main class="docs-content col-lg-11 col-xl-9 mx-xl-auto"><h1>Criptografía Asimétrica</h1><p class=lead></p><p><img src=../public_key_crypto.png alt="Criptografía de llave pública"></p><p>La <strong>criptografía asimétrica</strong> o <strong>criptografía de llave pública</strong> se diferencia de la criptografía simétrica en que se usan llaves distintas para cifrar y descifrar mensajes, lo que hace posible publicar la llave de cifrado con el objetivo de que otras personas puedan enviarnos mensajes que solo nosotros podremos descifrar, usando la llave de descifrado. Algo similar ocurre con la criptografía asimétrica usada para firmas digitales. Se usa una llave para &ldquo;demostrar&rdquo; que un mensaje fue enviado por nosotros mientras se publica la otra para que cualquiera pueda comprobar que la firma es válida.</p><p>En general, estos sistemas usan propiedades aritméticas para crear problemas matemáticos que son muy difíciles de resolver con información limitada, pero que conociendo un parámetro secreto puedes resolver de forma fácil.</p><h2 id=rsa>RSA<a href=#rsa class=anchor aria-hidden=true>#</a></h2><h3 id=cifrado>Cifrado<a href=#cifrado class=anchor aria-hidden=true>#</a></h3><p>Fue el primer esquema de cifrado de llave pública. Se destaca por el uso de aritmética modular, definiendo los siguientes parámetros:</p><ul><li>$n$ es un número formado por la multiplicación de dos números primos obtenidos al azar $p$ y $q$.</li><li>$Z_n^*$ es un grupo multiplicativo de enteros módulo $n$.</li><li>$x$ es nuestro <strong>mensaje en texto plano</strong>, codificado como un número perteneciente a $Z_n^*$. Debido a lo anterior, el tamaño de nuestro mensaje se encuentra limitado por la magnitud de $n$ (o sea, mientras más grande queramos que sea el mensaje a cifrar, más grande debe ser n).</li><li>$e$ es nuestro <strong>exponente público</strong> y corresponde a un número menor que $(p-1)(q-1)$.</li><li>$d$ es el inverso multiplicativo de e en el grupo $Z_n^*$, o sea, $d = 1/e \mod n$.</li><li>$y$ es nuestro <strong>mensaje cifrado</strong> y se calcula como $x^e \mod n$.</li></ul><p>La <strong>Llave pública</strong> en RSA es el par de elementos $(n, e)$, mientras que la <strong>llave privada</strong> es el valor $d$.</p><p>La gracia de saber que $n=pq$ es que esto nos permite calcular $d$ de forma eficiente, usando el <a href=https://en.wikipedia.org/wiki/Extended_Euclidean_algorithm>algoritmo euclidiano extendido</a>:</p><p>$extended_gcd(a,b) = ax + by$</p><p>En el algoritmo anterior, el valor de $d$ es igual al valor de $a$ al ejecutar $extended_gcd(e, (p-1)(q-1))$.</p><p>Les recomendamos leer el capítulo 10 del libro <em>Serious Cryptography</em> para entender por qué ocurre esto.</p><h4 id=cifrado-y-descifrado-en-rsa>Cifrado y descifrado en RSA<a href=#cifrado-y-descifrado-en-rsa class=anchor aria-hidden=true>#</a></h4><p>Para cifrar un mensaje en RSA, basta con calcular $y = x^e$, mientras que para descifrar el mensaje, basta con calcular $y^d$, ya que como $d$ es el inverso de $e$, $y^d = x^{e^d} = x^{ed} = x$.</p><p>En varias implementaciones, se suele fijar el valor de $e$ a un número pequeño, como por ejemplo $2^16+1$ *(65537), aunque también podría usarse $3$ o $17$ si se usa el padding adecuado (ver sección siguiente para más detalles).</p><h4 id=problemas-de-seguridad-en-rsa>Problemas de seguridad en RSA<a href=#problemas-de-seguridad-en-rsa class=anchor aria-hidden=true>#</a></h4><p>Una mala implementación de RSA puede generar problemas de seguridad que permitirían incluso descifrar un mensaje. A continuación mencionamos algunos de ellos:</p><ul><li><strong>$n$ muy pequeño</strong>: En general, se suele usar un $n$ de tamaño 2048 bits o más para que el nivel de seguridad del valor cifrado sea similar a un cifrado con llave simétrica de 112 bits. En la práctica, un $n$ de tamaño 300 bits o menos, éste es fácilmente factorizable en un computador de uso personal.</li><li><strong>$e$ muy pequeño y mensajes sin padding</strong>: Si $e$ es un valor muy pequeño, $x &lt; n^d$ y el mensaje cifrado $y$ no tiene <code>padding</code>, es posible calcular la raíz $e$ésima de $y$ para calcular $x$.</li><li><strong>Mala generación de números primos</strong>: Es muy importante que los números primos $p$ y $q$ se generen de forma aleatoria. En caso que esto no sea así, se corre el riesgo de encontrarlos, y con esto poder derivar el valor secreto $d$.</li><li><strong>Problemas de maleabilidad en valores cifrados</strong>: Supongamos que ciframos con la misma llave pública dos valores pequeños $x_1$ y $x_2$, obteniéndose $y_1$ e $y_2$ respectivamente. Si $y_1y_2 &lt; n$, una persona externa podría calcular el valor cifrado de $x_1x_2$ simplemente multiplicando los valores cifrados de $x_1$ y $x_2$. Para evitar este problema, se suele aplicar un <code>padding</code> especial a todos los valores cifrados con RSA, de forma que su representación numérica corresponda a un número grande.</li><li><strong>Computación Cuántica</strong> El problema de factorización en el cual se basa la seguridad de RSA es resolvible en tiempo polinomial con computadores cuánticos usando el <a href=https://en.wikipedia.org/wiki/Shor%27s_algorithm>algoritmo de Shor</a>. Afortunadamente, todavía no se conoce públicamente la existencia de un computador cuántico con la capacidad de factorizar números del tamaño de los usados en RSA.</li></ul><p>La <a href=https://en.wikipedia.org/wiki/RSA_(cryptosystem)>página en Wikipedia</a> menciona con mayor detalle los ataques posibles a RSA, sin embargo, la comprensión de algunos de estos problemas requieren recordar hartos contenidos de teoría de números.</p><h4 id=padding-en-cifrado-rsa-oaep>Padding en cifrado RSA: OAEP<a href=#padding-en-cifrado-rsa-oaep class=anchor aria-hidden=true>#</a></h4><p><img src=../oaep.jpg alt=OAEP></p><p>El diagrama anterior, obtenido del libro <strong>Serious Cryptography</strong>, muestra en términos generales el uso de padding en RSA. Uno de los algoritmos de padding más usados en RSA es OAEP, el cual funciona de la siguiente forma:</p><p><img src=../oaep_2.jpg alt=OAEP></p><ul><li>Se genera $M = H || 000 &mldr; 001 || K$ ($||$ significa concatenar), donde $H$ es una constante conocida, seguida de tantos bytes $00$ como sea necesario para que el tamaño de $M$ en bytes sea el mismo que el de $n$, seguido de un byte $01$. Finalmente, se coloca el mensaje original $K$.</li><li>La función $Hash1$ recibe de entrada un valor de largo igual al de $H$ y devuelve un valor de largo igual al de $M$. Llamaremos a este valor $A$</li><li>La función $Hash2$ recibe de entrada un valor de largo igual al de $M$ y devuelve un valor de largo igual al de $H$. Llamaremos a este valor $B$</li><li>El valor paddeado $P$ se construye de la siguiente forma: $P = 00 || B || A$. Este es el valor que se cifra con RSA finalmente.</li></ul><p>El proceso de descifrado requerirá seguir los pasos anteriores en orden inverso, con el objetivo de obtener el verdadero texto plano.</p><h3 id=firmas>Firmas<a href=#firmas class=anchor aria-hidden=true>#</a></h3><p>En el caso de RSA, para un documento M, se define su firma $S = M^d \mod n$, donde M es el mensaje a firmar. Para verificar la firma, es necesario calcular $S^e \mod n$ y comparar este valor con el documento recibido.</p><p>Hay que tener en consideración que, al igual que en el caso de cifrado RSA, el tamaño del mensaje a cifrar está limitado por el tamaño de $n$.</p><h4 id=potenciales-ataques-a-las-firmas-rsa>Potenciales ataques a las firmas RSA<a href=#potenciales-ataques-a-las-firmas-rsa class=anchor aria-hidden=true>#</a></h4><ul><li><strong>Firma de mensajes &ldquo;triviales&rdquo;</strong>: Si no se usa una función de padding, y existe la posibilidad de querer firmar un mensaje como $0$, $1$ o $n-1$. En todos estos casos, $x^d$ es igual a $x$, por lo que no es necesario conocer $d$ para generar la firma del mensaje.</li><li><strong>Blinding Attack</strong>: Si no se usa una función de padding y se quiere obtener la firma de un mensaje $M$ sin que la persona que firma el mensaje se entere que lo firmó, se le puede pasar un mensaje $R^eM$ para firmarlo. La firma de este mensaje corresponderá a $(R^eM)^d = R^{ed}M^d = RM^d$. Este valor se puede dividir por R de forma de obtener $M^d$, que es la firma del mensaje M.</li></ul><h4 id=padding-en-firmas-rsa>Padding en firmas RSA<a href=#padding-en-firmas-rsa class=anchor aria-hidden=true>#</a></h4><p>A continuación se mencionan dos algoritmos de padding que suelen usarse en RSA:</p><h5 id=pss>PSS<a href=#pss class=anchor aria-hidden=true>#</a></h5><p>Lamentablemente, no hay demostración de que OAEP es un método de padding seguro para firmas RSA. Sin embargo, existe otro algoritmo de padding para este caso, denominado PSS.</p><p>La implementación de PSS es algo compleja, por lo que la enlazaremos solamente: <a href=https://web.archive.org/web/20170810025803/http://grouper.ieee.org/groups/1363/P1363a/contributions/pss-submission.pdf>referencia</a>.</p><h5 id=fdh>FDH<a href=#fdh class=anchor aria-hidden=true>#</a></h5><p>Full Domain Hash es una forma más simple de paddear un documento, ya que considera simplemente calcular su hash con alguna función de hashing segura y luego firmar ese valor. Formalmente, no está demostrada su seguridad, pero en la práctica se considera una buena función de padding, debido a que su simplicidad disminuye considerablemente la posibilidad de error en implementación que sí posee PSS.</p><h2 id=acuerdo-de-llaves-diffie-hellman>Acuerdo de llaves Diffie-Hellman<a href=#acuerdo-de-llaves-diffie-hellman class=anchor aria-hidden=true>#</a></h2><p>En general se considera que Withfeld Diffie y Martin Hellman son los creadores del concepto de criptografía de llave pública. Ellos crearon también un esquema para acordar una llave compartida entre dos partes, denominado generalmente como <code>protocolo Diffie-Hellman</code>. Este protocolo requiere de los siguientes valores:</p><ul><li>Un número primo grande $p$ de forma de definir un grupo multiplicativo $Z_p^*$ sobre el cual trabajar.</li><li>Un número generador $g$, perteneciente a $Z_p^*$. En general se suele usar $g = 2$.</li><li>Cada parte que desea comunicarse debe elegir un número aleatorio en $Z_p^*$. Los denominaremos $a$ y $b$ para $Alicia$ y $Bob$ respectivamente.</li></ul><p>En este caso, se consideran como llave pública los valores $g^a$ y $g^b$, y como llave privada los valores $a$ y $b$.</p><p><img src=../dh.jpg alt="Diffie Hellman según Serious Cryptography"></p><p>Para obtener el valor compartido que usarán como llave simétrica para comunicarse, primero Alicia envía a Bob el número $g^a$ y Bob envía a Alicia el número $g^b$. Si existiese una persona entre medio observando el intercambio, no tendría como deducir $a$ o $b$ a partir de $g^a$ o $g^b$ (al problema de obtener $x$ a partir de un $g^x \mod p$ se le conoce como de <a href=https://en.wikipedia.org/wiki/Discrete_logarithm>el problema del logaritmo discreto</a> y se considera que no existe un método general de resolución para él).</p><p>Finalmente, para calcular el secreto compartido, cada parte eleva el valor recibido por su número aleatorio secreto. De esta forma, Alicia obtendrá $g^{a^b} = g^{ab}$, mientras que Bob obtendrá $g^{b^a} = g^{ba} = g^{ab}$. Ahora, ambas partes pueden usar ese valor compartido para cifrar mensajes.</p><h3 id=problemas-de-seguridad-dh>Problemas de seguridad DH<a href=#problemas-de-seguridad-dh class=anchor aria-hidden=true>#</a></h3><p><img src=../dh_mitm.jpg alt="MITM en Diffie Hellman según Serious Cryptography"></p><ul><li><strong>Man-In-The-Middle Attack (Ataque de Entidad al medio de la comunicación)</strong>: DH provee un mecanismo para negociar un valor secreto entre dos partes, pero no tiene en cuenta la necesidad de autentificar que la persona con la que hablas es quien dice ser. Nada evita que una tercera entidad que controle el canal de comunicación (Eva) pueda hacerse pasar por Bob frente a Alice, y por Alice frente a bob, generando dos números aleatorios $c$ y $d$ y sus respectivas llaves públicas $g^c$ y $g^d$. Eva recibiría tanto $g^a$ como $g^b$ y los guardaría, mientras envía $g^c$ y $g^d$ a Alicia y Bob respectivamente. El secreto compartido entre Alicia y Eva será $g^{ac}$ mientras que el secreto compartido entre Bob y Eva será $g^{bd}$. Cada vez que Alicia o Bob envíen un mensaje a Eva, ella podrá descifrarlo usando el secreto del emisor, y luego recifrarlo con el secreto del receptor. Para evitar este problema, se podría firmar la llave pública enviada a la contraparte utilizando algún otro metodo de criptografía de llave pública negociado con anterioridad.</li><li><strong>Replay Attacks (Ataques de Repetición)</strong>: Incluso si se pudiera autenticar el mensaje, no hay forma de demostrar si el mensaje que viene de Alicia fue emitido ahora o fue emitido hace tiempo, pero ahora Eva lo está reenviando. Una forma de evitar este problema es agregando interactividad al protocolo de generación del secreto compartido, por ejemplo, pidiendo recibir un &ldquo;valor de confirmación&rdquo; que utilice tanto la llave pública de Alicia como la de Bob en ese momento para su generación.</li><li><strong>Uso directo de $g^{ab}$ como secreto compartido</strong>: Sabemos por lo visto que $g^ab$ es un número aleatorio del grupo $Z_p^*$. Sin embargo, esto no significa que sea un número aleatorio (en el sentido que la probabilidad de cada bit de ser 0 o 1 sea la misma), dado que el grupo que forma el generador $g$ podría tener algún sesgo en la codificación de los números generados. Para evitar esta posibilidad, se suele hashear el valor $g^{ab}$ con alguna función resistente a colisiones, como SHA3 o alguna KDF.</li></ul><h2 id=criptografía-de-curvas-elípticas>Criptografía de Curvas Elípticas<a href=#criptografía-de-curvas-elípticas class=anchor aria-hidden=true>#</a></h2><p>La criptografía de curvas elípticas (ECC) utiliza la estructura algebráica de curvas elípticas sobre cuerpos finitos que puee ser usada tanto para negociación de llaves como para firmas digitales, y tiene la ventaja de que las llaves y firmas producidas en ella suelen ser mucho más pequeñas que las de Diffie-Hellman o RSA, manteniendo el nivel de seguridad. En este curso no trataremos con ellas, pero en caso de querer saber más, recomendamos leer el capítulo 12 del libro <strong>Serious Cryptography</strong>.</p><p class=edit-page><a href=https://github.com/cc5325/apunte/blob/main/content/docs/cripto-moderna/cripto-asimetrica.md><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit-2"><path d="M17 3a2.828 2.828.0 114 4L7.5 20.5 2 22l1.5-5.5L17 3z"/></svg>Editar en GitHub</a>
<span class=date-info><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>Modificado por última vez el 13/04/2021 a las 04:02:37 hrs.</span></p><div class="docs-navigation d-flex justify-content-between"><a href=/docs/stego/stego/><div class="card my-1"><div class="card-body py-2">&larr; Stego en texto, imágenes y audio</div></div></a><a class=ml-auto href=/docs/stego/ejercicios/><div class="card my-1"><div class="card-body py-2">Ejercicios de Stego &rarr;</div></div></a></div></main></div></div></div><footer class="footer text-muted"><div class=container><div class=row><div class="col-lg-8 order-last order-lg-first"><ul class=list-inline><li class=list-inline-item>Sitio generado con <a href=https://gohugo.io/>Hugo</a> y <a href=https://getdoks.org/>Doks</a></li></ul></div><div class="col-lg-8 order-first order-lg-last text-lg-right"><ul class=list-inline><a href="http://creativecommons.org/licenses/by-sa/4.0/?ref=chooser-v1" target=_blank rel="license noopener noreferrer" style=display:inline-block>CC BY-SA 4.0<img style=height:22px!important;margin-left:3px;vertical-align:text-bottom src="https://mirrors.creativecommons.org/presskit/icons/cc.svg?ref=chooser-v1"><img style=height:22px!important;margin-left:3px;vertical-align:text-bottom src="https://mirrors.creativecommons.org/presskit/icons/by.svg?ref=chooser-v1"><img style=height:22px!important;margin-left:3px;vertical-align:text-bottom src="https://mirrors.creativecommons.org/presskit/icons/sa.svg?ref=chooser-v1"></a></ul></div></div></div></footer><script src=/main.95e1e463215c36b92eed561d2047bd705784633ba53d9459f103fad71ac9237a03e92e1413824339f4dcfe6e260239c0e4237a48be33d73a1e686e025142d2ba.js integrity="sha512-leHkYyFcNrku7VYdIEe9cFeEYzulPZRZ8QP61xrJI3oD6S4UE4JDOfTc/m4mAjnA5CN6SL4z1zoeaG4CUULSug==" crossorigin=anonymous defer></script><script src=/index.min.bc496c3f597b76e37c4c04d59c92a2fb34d8a3fc9bca16767f48dc461880a0d5e80f2872513282d825c5ab307b550bc198054113b3d1754d1c48ef30bae53f08.js integrity="sha512-vElsP1l7duN8TATVnJKi+zTYo/ybyhZ2f0jcRhiAoNXoDyhyUTKC2CXFqzB7VQvBmAVBE7PRdU0cSO8wuuU/CA==" crossorigin=anonymous defer></script><script>MathJax={tex:{inlineMath:[['$','$'],['\\(','\\)']],displayMath:[['$$','$$'],['\\[','\\]']],processEscapes:true,processEnvironments:true},options:{skipHtmlTags:['script','noscript','style','textarea','pre']}};window.addEventListener('load',(event)=>{document.querySelectorAll("mjx-container").forEach(function(x){x.parentElement.classList+='has-jax'})});</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script type=text/javascript id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script></body></html>